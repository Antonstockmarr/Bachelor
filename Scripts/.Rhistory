plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (0,0,1)x(0,0,1) seasonal model, with S=12")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
rm(list=ls())
par(mfrow=c(1,1))
set.seed(0)
colors=rainbow(10)
# Simulate 10 ARMA realisations (arima.sim(1,0,2))
dat=matrix(NA, nrow=10,ncol=200)
for(i in 1:10){
dat[i,]=arima.sim(model=list(ar=0.9,ma=c(2,0.5)),n=200,sd=0.2)
}
acf(dat[1,])
plot(dat[1,],type="l",col=colors[1],ylim=c(-5,5),main="The 10 simulated ARMA(1,2) models",ylab="Simulation value",xlab="Observation")
lm=50
for(i in 2:10){
lines(dat[i,],type="l",col=colors[i])
}
acf1<-acf(dat[1,],plot=FALSE,lag.max = lm)
acf1$acf[,1,1]
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-0.5,1),type="l",col=colors[1],main="Autocorrelation function for the 10 simulations")
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm)
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
##
plot(dat[1,],type="l")
pacf(dat[1,])
pacf1<-pacf(dat[1,],plot=FALSE,lag.max = lm)
pacf1$acf[,1,1]
plot(pacf1,xlim=c(.5,lm-2),ylim=c(-.5,1),type="l",col=1,main="Partial autocorrelation function for the 10 simulations")
for(i in 2:10){
pacftmp<-pacf(dat[i,],plot=FALSE,lag.max = lm)
lines(1:lm,pacftmp$acf[,1,1],col=i)
}
avars=rep(NA,10)
for(i in 1:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm,type="covariance")
avars[i]<-acftmp$acf[1,1,1]
}
avars
acf(log(tab$NO2[train]),lag.max = 200)
source('C:/Users/mikke/Desktop/6. sem/Bach/Bachelor-f19/Scripts/MikkelsHyggescript.R', echo=TRUE)
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in min(t):(max(t)-1)){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-min(t)+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
alpha[i]<-min(which(pct.in.sd>0.8 == TRUE))
}
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
pct.in.sd>0.8
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in min(t):(max(t)-1)){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-min(t)+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
alpha[i]<-min(which(pct.in.sd<0.8 == TRUE))
}
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in min(t):(max(t)-1)){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-min(t)+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
alpha[i]<-min(which((pct.in.sd<0.8) == TRUE))
}
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
alpha-min(t)+1
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in min(t):(max(t)-1)){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
alpha[i]<-min(which((pct.in.sd<0.8) == TRUE))
}
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha-round(min(t))+1
pct.in.sd>0.8
pct.in.sd
pct.in.sd<0.8)
pct.in.sd<0.8
which(pct.in.sd<0.8)
min(which(pct.in.sd<0.8))
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in floor(min(t):(max(t)-1))){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
alpha[i]<-min(which(pct.in.sd<0.8))-floor(min(t))+1
}
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in floor(min(t):(max(t)-1))){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+3*tmp.sd)+sum(tmp.q<=tmp.mu-3*tmp.sd))/length(tmp.q)
alpha[i]<-min(which(pct.in.sd<0.8))-floor(min(t))+1
}
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in floor(min(t):(max(t)-1))){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
alpha[i]<-min(which(pct.in.sd<0.8))-floor(min(t))+1
}
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in floor(min(t):(max(t)-1))){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+3*tmp.sd)+sum(tmp.q<=tmp.mu-3*tmp.sd))/length(tmp.q)
alpha[i]<-min(which(pct.in.sd<1))-floor(min(t))+1
}
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in floor(min(t):(max(t)-1))){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+3*tmp.sd)+sum(tmp.q<=tmp.mu-3*tmp.sd))/length(tmp.q)
alpha[k]<-min(which(pct.in.sd<1))-floor(min(t))+1
}
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
floor(min(t):(max(t)-1))
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in floor(min(t):(max(t)-1))){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
alpha[k]<-min(which(pct.in.sd<0.8))-i
}
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in floor(min(t):(max(t)-1))){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
alpha[j]<-min(which(pct.in.sd<0.8))-i
j=j+1
}
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
rep(0,n)
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in floor(min(t):(max(t)-1))){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
}
alpha[j]<-min(which(pct.in.sd<0.8))-i
j=j+1
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
min(which(pct.in.sd<0.8))-i
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in floor(min(t):(max(t)-1))){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
}
alpha[j]<-min(which(pct.in.sd<0.8))-floor(min(t)+1)
j=j+1
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
alpha <- rep(0,n)
j=1
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in floor(min(t):(max(t)-1))){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
}
alpha[j]<-min(which(pct.in.sd<0.8))-floor(min(t)+1)
j=j+1
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
floor(min(t)+1)
min(which(pct.in.sd<0.8))
min(which(pct.in.sd<0.8))-floor(min(t)+1)
alpha <- rep(0,n)
j=1
for(k in 1:n){
if (length(day.data[[k]]$Flow)>=365){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
tmp.mu <- mean(q[t>=20])
tmp.sd <- sd(q[t>=20])
if(tmp.sd!=0){
tmp.sd.dist <-(q-tmp.mu)/tmp.sd
par(mfrow=c(1,2))
plot(t,tmp.sd.dist,main=k)#,xlim=c(5,25))
lines(t,rep((2),length(t)),col=2)
lines(t,rep((2),length(t)),col=2)
pct.in.sd <- rep(0,length(min(t):(max(t)-1)))
for (i in floor(min(t):(max(t)-1))){
tmp.q <- q[t<=(i+1)]
tmp.t <- t[t<=(i+1)]
tmp.q <- tmp.q[tmp.t>i]
tmp.t <- tmp.t[tmp.t>i]
pct.in.sd[i-round(min(t))+1] <- (sum(tmp.q>=tmp.mu+2*tmp.sd)+sum(tmp.q<=tmp.mu-2*tmp.sd))/length(tmp.q)
}
alpha[j]<-min(which(pct.in.sd<0.8))+floor(min(t)+1)
j=j+1
plot(min(t):(max(t)-1),pct.in.sd)
}
}
}
alpha
alpha<-alpha[alpha>0]
alpha
hist(alpha)
quantile(alpha)
quantile(alpha, .15)
quantile(alpha, .20)
quantile(alpha, .25)
quantile(alpha, .15)
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[42],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[42],tz="GMT"),]
day.no.summer<-day.data
str(day.no.summer)
i=1
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[i],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[i],tz="GMT"),]
tmp.nos<-day.data[[i]]
tmp.nos<-tmp.nos[,day.tmp$Temperature<=12]
tmp.nos<-tmp.nos[day.tmp$Temperature<=12,]
tmp.nos
for (i in 1:n) {
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[i],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[i],tz="GMT"),]
tmp.nos<-day.data[[i]]
tmp.nos<-tmp.nos[day.tmp$Temperature<=12,]
day.no.summer[[i]]<-tmp.nos
}
day.no.summer[[1]]$Date
