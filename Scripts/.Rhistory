acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm)
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
##
plot(dat[1,],type="l")
pacf(dat[1,])
pacf1<-pacf(dat[1,],plot=FALSE,lag.max = lm)
pacf1$acf[,1,1]
plot(pacf1,xlim=c(.5,lm-2),ylim=c(-.5,1),type="l",col=1,main="Partial autocorrelation function for the 10 simulations")
for(i in 2:10){
pacftmp<-pacf(dat[i,],plot=FALSE,lag.max = lm)
lines(1:lm,pacftmp$acf[,1,1],col=i)
}
avars=rep(NA,10)
for(i in 1:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm,type="covariance")
avars[i]<-acftmp$acf[1,1,1]
}
avars
acf(log(tab$NO2[train]),lag.max = 200)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source("data.R")
# 64 vælges da det er godt:
str(day.data[[64]])
i=64
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[i],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[i],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[i]]$CoolingDegree*day.data[[i]]$Volume
tmp.fit<-lm(q~t)
plot(tmp.fit)
plot(q~t)
(tmp.fit<-lm(q~t))
(tmp.fit<-lm(q~t))
#plot(q~t)
newdata <- seq(min(t),max(t),length=30)
conf_interval <- predict(fit, newdata=data.frame(t=newdata), interval='confidence')
conf_interval <- predict(tmp.fit, newdata=data.frame(t=newdata), interval='confidence')
plot(newdata,conf_interval[,1],ylab='Consumption',xlab='Temperature',
main = paste('House number', i),col='red',type='l',ylim=c(0,max(q)))
points(q~t)
matlines(newdata,conf_interval[,2],col="green",lwd=1,lty='dashed')
matlines(newdata,conf_interval[,3],col="green",lwd=1,lty='dashed')
tmp.fit$model
plot(tmp.fit$model)
(tmp.fit<-lm(q~t))
str(tmp.fit)
sigma(tmp.fit)
fitted.temp <- 0:max(day.weather$Temperature)
tmp.fit$coefficients[1]
tmp.fit$coefficients[2]
tmp.fit$coefficients[2]+3
?rep
plot.points <-rbind(rep(3,rep(0,length(fitted.temp)),3))
plot.points <-rbind(rep(rep(0,length(fitted.temp),3)))
plot.points <-rbind(rep(0,length(fitted.temp)),rep(0,length(fitted.temp)))
plot.points <-rbind(rep(0,length(fitted.temp)),rep(0,length(fitted.temp)),rep(0,length(fitted.temp)))
fitted.temp <- 0:max(day.weather$Temperature)
plot.points <-rbind(rep(0,length(fitted.temp)),rep(0,length(fitted.temp)),rep(0,length(fitted.temp)))
for (i in fitted.tmp){
tmp.fit<-lm(q[t<i]~t[t<i])
plot.points[,i]<-tmp.fit$coefficients[2]+c(2,0,-2)*sigma(tmp.fit)
}
for (i in fitted.temp){
tmp.fit<-lm(q[t<i]~t[t<i])
plot.points[,i]<-tmp.fit$coefficients[2]+c(2,0,-2)*sigma(tmp.fit)
}
plot(plot.points[2,])
points(plot.points[1,],col=2)
points(plot.points[3,],col=2)
plot(plot.points[2,],ylim=c(-.3,.3))
points(plot.points[1,],col=2)
points(plot.points[3,],col=2)
plot(plot.points[2,],fitted.temp,ylim=c(-.3,.3))
plot(fitted.temp,plot.points[2,],ylim=c(-.3,.3))
plot(fitted.temp,plot.points[2,])
t <- day.tmp$Temperature
str(day.data[[64]])
i=64
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[i],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[i],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[i]]$CoolingDegree*day.data[[i]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- 0:max(day.weather$Temperature)
plot.points <-rbind(rep(0,length(fitted.temp)),rep(0,length(fitted.temp)),rep(0,length(fitted.temp)))
for (i in fitted.temp){
tmp.fit<-lm(q[t<i]~t[t<i])
plot.points[,i]<-tmp.fit$coefficients[2]+c(2,0,-2)*sigma(tmp.fit)
}
for (i in fitted.temp){
tmp.fit<-lm(q[t<=i]~t[t<=i])
plot.points[,i]<-tmp.fit$coefficients[2]+c(2,0,-2)*sigma(tmp.fit)
}
plot(fitted.temp,plot.points[2,])
points(plot.points[1,],col=2)
points(plot.points[3,],col=2)
plot.points
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source("data.R")
# 64 vælges da det er godt:
str(day.data[[64]])
i=64
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[i],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[i],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[i]]$CoolingDegree*day.data[[i]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- 0:max(day.weather$Temperature)
plot.points <-rbind(rep(0,length(fitted.temp)),rep(0,length(fitted.temp)),rep(0,length(fitted.temp)))
for (i in fitted.temp){
tmp.fit<-lm(q[t<=i]~t[t<=i])
plot.points[,i-1]<-tmp.fit$coefficients[2]+c(2,0,-2)*sigma(tmp.fit)
}
plot(fitted.temp,plot.points[2,])
points(fitted.temp,plot.points[1,],col=2)
points(fitted.temp,plot.points[3,],col=2)
for (i in fitted.temp){
tmp.fit<-lm(q[t<=i]~t[t<=i])
plot.points[,i+1]<-tmp.fit$coefficients[2]+c(2,0,-2)*sigma(tmp.fit)
}
plot(fitted.temp,plot.points[2,])
points(fitted.temp,plot.points[1,],col=2)
points(fitted.temp,plot.points[3,],col=2)
plot(fitted.temp,plot.points[2,],ylim=c(-1,1))
points(fitted.temp,plot.points[1,],col=2)
points(fitted.temp,plot.points[3,],col=2)
plot(fitted.temp,plot.points[2,],ylim=c(-.7,1.7))
plot(fitted.temp,plot.points[2,],ylim=c(-.7,.7))
points(fitted.temp,plot.points[1,],col=2)
points(fitted.temp,plot.points[3,],col=2)
plot(fitted.temp,plot.points[2,],ylim=c(-1,.7))
plot(q~t)
i=68
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[i],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[i],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[i]]$CoolingDegree*day.data[[i]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- 0:max(day.weather$Temperature)
plot.points <-rbind(rep(0,length(fitted.temp)),rep(0,length(fitted.temp)),rep(0,length(fitted.temp)))
for (i in fitted.temp){
tmp.fit<-lm(q[t<=i]~t[t<=i])
plot.points[,i+1]<-tmp.fit$coefficients[2]+c(2,0,-2)*sigma(tmp.fit)
}
plot(fitted.temp,plot.points[2,],ylim=c(-1,.7))
points(fitted.temp,plot.points[1,],col=2)
points(fitted.temp,plot.points[3,],col=2)
i=42
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[i],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[i],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[i]]$CoolingDegree*day.data[[i]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- 0:max(day.weather$Temperature)
plot.points <-rbind(rep(0,length(fitted.temp)),rep(0,length(fitted.temp)),rep(0,length(fitted.temp)))
for (i in fitted.temp){
tmp.fit<-lm(q[t<=i]~t[t<=i])
plot.points[,i+1]<-tmp.fit$coefficients[2]+c(2,0,-2)*sigma(tmp.fit)
}
plot(fitted.temp,plot.points[2,])#,ylim=c(-1,.7))
plot(fitted.temp,plot.points[2,],main=n)#,ylim=c(-1,.7))
k=42
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- 0:max(day.weather$Temperature)
plot.points <-rbind(rep(0,length(fitted.temp)),rep(0,length(fitted.temp)),rep(0,length(fitted.temp)))
for (i in fitted.temp){
tmp.fit<-lm(q[t<=i]~t[t<=i])
plot.points[,i+1]<-tmp.fit$coefficients[2]+c(2,0,-2)*sigma(tmp.fit)
}
plot(fitted.temp,plot.points[2,],main=k)#,ylim=c(-1,.7))
# 68 vælges da det er godt:
if(TRUE){
k=38
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- 0:max(day.weather$Temperature)
plot.points <-rbind(rep(0,length(fitted.temp)),rep(0,length(fitted.temp)),rep(0,length(fitted.temp)))
for (i in fitted.temp){
tmp.fit<-lm(q[t<=i]~t[t<=i])
plot.points[,i+1]<-tmp.fit$coefficients[2]+c(2,0,-2)*sigma(tmp.fit)
}
plot(fitted.temp,plot.points[2,],main=k)#,ylim=c(-1,.7))
}
points(fitted.temp,plot.points[1,],col=2)
points(fitted.temp,plot.points[3,],col=2)
# 68 vælges da det er godt:
for(k in 1:n){
if(TRUE){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- 0:max(day.weather$Temperature)
plot.points <-rbind(rep(0,length(fitted.temp)),rep(0,length(fitted.temp)),rep(0,length(fitted.temp)))
for (i in fitted.temp){
tmp.fit<-lm(q[t<=i]~t[t<=i])
plot.points[,i+1]<-tmp.fit$coefficients[2]+c(2,0,-2)*sigma(tmp.fit)
}
plot(fitted.temp,plot.points[2,],main=k)#,ylim=c(-1,.7))
}
}
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- (min(day.tmp$Temperature)+5):max(day.tmp$Temperature)
plot.points <-rep(0,length(fitted.temp))
for (i in fitted.temp){
q.tmp <- q[t<i]
q.tmp <- q.tmp[t>i-5]
plot.points[i+1]<-min(q.tmp)
}
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- (min(day.tmp$Temperature)+5):max(day.tmp$Temperature)
plot.points <-rep(0,length(fitted.temp))
for (i in fitted.temp){
q.tmp <- q[t<i]
q.tmp <- q.tmp[t>i-5]
plot.points[i-min(day.tmp$Temperature)]<-min(q.tmp)
}
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- (min(day.tmp$Temperature)+5):max(day.tmp$Temperature)
plot.points <-rep(0,length(fitted.temp))
for (i in fitted.temp){
q.tmp <- q[t<i]
q.tmp <- q.tmp[t>i-5]
plot.points[i-fitted.temp(1)+1]<-min(q.tmp)
}
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- (min(day.tmp$Temperature)+5):max(day.tmp$Temperature)
plot.points <-rep(0,length(fitted.temp))
for (i in fitted.temp){
q.tmp <- q[t<i]
q.tmp <- q.tmp[t>i-5]
plot.points[i-fitted.temp[1]+1]<-min(q.tmp)
}
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
t
min(t)
min(maks)
max(t)
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- (floor(min(day.tmp$Temperature))+5):ciel(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
for (i in fitted.temp){
q.tmp <- q[t<i]
q.tmp <- q.tmp[t>i-5]
plot.points[i-fitted.temp[1]+1]<-min(q.tmp)
}
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- (floor(min(day.tmp$Temperature))+5):ceil(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
for (i in fitted.temp){
q.tmp <- q[t<i]
q.tmp <- q.tmp[t>i-5]
plot.points[i-fitted.temp[1]+1]<-min(q.tmp)
}
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- (floor(min(day.tmp$Temperature))+5):ceiling(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
for (i in fitted.temp){
q.tmp <- q[t<i]
q.tmp <- q.tmp[t>i-5]
plot.points[i-fitted.temp[1]+1]<-min(q.tmp)
}
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
(tmp.fit<-lm(q~t))
fitted.temp <- (floor(min(day.tmp$Temperature))+5):ceiling(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
k=1
for (i in fitted.temp){
q.tmp <- q[t<i]
q.tmp <- q.tmp[t>i-5]
plot.points[k]<-min(q.tmp)
k=k+1
}
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
fitted.temp <- (floor(min(day.tmp$Temperature))+10):ceiling(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
k=1
for (i in fitted.temp){
q.tmp <- q[t<i]
q.tmp <- q.tmp[t>i-10]
plot.points[k]<-min(q.tmp)
k=k+1
}
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
fitted.temp <- (floor(min(day.tmp$Temperature))+5):ceiling(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
obs <-rep(0,length(fitted.temp))
k=1
for (i in fitted.temp){
q.tmp <- q[t<=i]
q.tmp <- q.tmp[t>i-5]
plot.points[k]<-min(q.tmp)
obs[k]<-length(q.tmp)
k=k+1
}
plot(obs)
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
plot(obs)
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
fitted.temp <- (floor(min(day.tmp$Temperature))+5):ceiling(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
obs <-rep(0,length(fitted.temp))
k=1
for (i in fitted.temp){
q.tmp <- q[t<=i]
t.tmp <- t[t<=i]
q.tmp <- q.tmp[t.tmp>i-5]
plot.points[k]<-min(q.tmp)
obs[k]<-length(q.tmp)
k=k+1
}
plot(obs)
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 44){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
fitted.temp <- (floor(min(day.tmp$Temperature))+5):ceiling(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
obs <-rep(0,length(fitted.temp))
j=1
for (i in fitted.temp){
q.tmp <- q[t<=i]
t.tmp <- t[t<=i]
q.tmp <- q.tmp[t.tmp>i-5]
plot.points[j]<-min(q.tmp)
obs[j]<-length(q.tmp)
j=j+1
}
plot(obs)
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
plot(obs)
plot(plot.points,main=k)#,ylim=c(-1,.7))
for(k in 1:n){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
fitted.temp <- (floor(min(day.tmp$Temperature))+5):ceiling(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
obs <-rep(0,length(fitted.temp))
j=1
for (i in fitted.temp){
q.tmp <- q[t<=i]
t.tmp <- t[t<=i]
q.tmp <- q.tmp[t.tmp>i-5]
plot.points[j]<-min(q.tmp)
obs[j]<-length(q.tmp)
j=j+1
}
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 1:n){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
fitted.temp <- (floor(min(day.tmp$Temperature))+1):ceiling(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
obs <-rep(0,length(fitted.temp))
j=1
for (i in fitted.temp){
q.tmp <- q[t<=i]
t.tmp <- t[t<=i]
q.tmp <- q.tmp[t.tmp>i-1]
plot.points[j]<-min(q.tmp)
obs[j]<-length(q.tmp)
j=j+1
}
plot(plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 1:n){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
fitted.temp <- (floor(min(day.tmp$Temperature))+1):ceiling(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
obs <-rep(0,length(fitted.temp))
j=1
for (i in fitted.temp){
q.tmp <- q[t<=i]
t.tmp <- t[t<=i]
q.tmp <- q.tmp[t.tmp>i-1]
plot.points[j]<-min(q.tmp)
obs[j]<-length(q.tmp)
j=j+1
}
plot(plot.points,fitted.temp,main=k)#,ylim=c(-1,.7))
}
for(k in 1:n){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
fitted.temp <- (floor(min(day.tmp$Temperature))+1):ceiling(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
obs <-rep(0,length(fitted.temp))
j=1
for (i in fitted.temp){
q.tmp <- q[t<=i]
t.tmp <- t[t<=i]
q.tmp <- q.tmp[t.tmp>i-1]
plot.points[j]<-min(q.tmp)
obs[j]<-length(q.tmp)
j=j+1
}
plot(fitted.temp,plot.points,main=k)#,ylim=c(-1,.7))
}
for(k in 1:n){
day.tmp <- day.weather[(day.weather$Date <= as.Date(EndDays[k],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(StartDays[k],tz="GMT"),]
t <- day.tmp$Temperature
q <- day.data[[k]]$CoolingDegree*day.data[[k]]$Volume
fitted.temp <- (floor(min(day.tmp$Temperature))+2):ceiling(max(day.tmp$Temperature))
plot.points <-rep(0,length(fitted.temp))
obs <-rep(0,length(fitted.temp))
j=1
for (i in fitted.temp){
q.tmp <- q[t<=i]
t.tmp <- t[t<=i]
q.tmp <- q.tmp[t.tmp>i-2]
plot.points[j]<-min(q.tmp)
obs[j]<-length(q.tmp)
j=j+1
}
plot(fitted.temp,plot.points,main=k)#,ylim=c(-1,.7))
}
