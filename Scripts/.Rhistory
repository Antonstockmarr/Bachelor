lines(tv,R,type="s")
plot(tv,I,type="s",xlab="Time",ylab="I")
N <- 1000  # Number of individuals in the population
I0 <- 1   # Initial number of infected
S0 <- N-I0 # Vi har ikke recovered endnu, så det er N pr. de syge
## Define state vector
X <- rep(1,N) # "1" codes "susceptible", "2" codes "infected", "3" codes "recovered"
X[1:I0] <- 2
## Model parameters
gamma <- 1
R_0 <- 2
beta <- (R_0*gamma)/S0 # Udtryk for R0 og isolere beta
## Simulation parameters
T <- floor(365/2)
dt <- (T/24)/30
nt <- T/dt
tv <- seq(0,T,dt)
## Output
S <- I <- R <- numeric(nt+1)
S[1] <- sum(X == 1)
I[1] <- sum(X == 2)
R[1] <- sum(X == 3)
## Main loop
for(i in 1:nt)
{
for(j in 1:N)
{
if(X[j] == 2) ## Let each "Infected" "Recover" with probability gamma*dt
{
if(runif(1) < gamma*dt) X[j] <- 3
}
if(X[j] == 1)
{
if(runif(1) < beta*I[i]*dt) X[j] <- 2
}
}
S[i+1] <- sum(X == 1)
I[i+1] <- sum(X == 2)
R[i+1] <- sum(X == 3)
}
## Plots
par(mfrow=c(1,2))
plot(tv,S,type="s",ylim=c(0,N),xlab="Time",ylab="S,R")
lines(tv,R,type="s")
plot(tv,I,type="s",xlab="Time",ylab="I")
N <- 1000  # Number of individuals in the population
I0 <- 1   # Initial number of infected
S0 <- N-I0 # Vi har ikke recovered endnu, så det er N pr. de syge
## Define state vector
X <- rep(1,N) # "1" codes "susceptible", "2" codes "infected", "3" codes "recovered"
X[1:I0] <- 2
## Model parameters
gamma <- 1
R_0 <- 2
beta <- (R_0*gamma)/S0 # Udtryk for R0 og isolere beta
## Simulation parameters
T <- floor(365/2)
dt <- (T/24)/30
nt <- T/dt
tv <- seq(0,T,dt)
## Output
S <- I <- R <- numeric(nt+1)
S[1] <- sum(X == 1)
I[1] <- sum(X == 2)
R[1] <- sum(X == 3)
## Main loop
for(i in 1:nt)
{
for(j in 1:N)
{
if(X[j] == 2) ## Let each "Infected" "Recover" with probability gamma*dt
{
if(runif(1) < gamma*dt) X[j] <- 3
}
if(X[j] == 1)
{
if(runif(1) < beta*I[i]*dt) X[j] <- 2
}
}
S[i+1] <- sum(X == 1)
I[i+1] <- sum(X == 2)
R[i+1] <- sum(X == 3)
}
## Plots
par(mfrow=c(1,2))
plot(tv,S,type="s",ylim=c(0,N),xlab="Time",ylab="S,R")
lines(tv,R,type="s")
plot(tv,I,type="s",xlab="Time",ylab="I")
N <- 1000  # Number of individuals in the population
I0 <- 1   # Initial number of infected
S0 <- N-I0 # Vi har ikke recovered endnu, så det er N pr. de syge
## Define state vector
X <- rep(1,N) # "1" codes "susceptible", "2" codes "infected", "3" codes "recovered"
X[1:I0] <- 2
## Model parameters
gamma <- 1
R_0 <- 2
beta <- (R_0*gamma)/S0 # Udtryk for R0 og isolere beta
## Simulation parameters
T <- floor(365/2)
dt <- (T/24)/30
nt <- T/dt
tv <- seq(0,T,dt)
## Output
S <- I <- R <- numeric(nt+1)
S[1] <- sum(X == 1)
I[1] <- sum(X == 2)
R[1] <- sum(X == 3)
## Main loop
for(i in 1:nt)
{
for(j in 1:N)
{
if(X[j] == 2) ## Let each "Infected" "Recover" with probability gamma*dt
{
if(runif(1) < gamma*dt) X[j] <- 3
}
if(X[j] == 1)
{
if(runif(1) < beta*I[i]*dt) X[j] <- 2
}
}
S[i+1] <- sum(X == 1)
I[i+1] <- sum(X == 2)
R[i+1] <- sum(X == 3)
}
## Plots
par(mfrow=c(1,2))
plot(tv,S,type="s",ylim=c(0,N),xlab="Time",ylab="S,R")
lines(tv,R,type="s")
plot(tv,I,type="s",xlab="Time",ylab="I")
N <- 1000  # Number of individuals in the population
I0 <- 1   # Initial number of infected
S0 <- N-I0 # Vi har ikke recovered endnu, så det er N pr. de syge
## Define state vector
X <- rep(1,N) # "1" codes "susceptible", "2" codes "infected", "3" codes "recovered"
X[1:I0] <- 2
## Model parameters
gamma <- 1
R_0 <- 2
beta <- (R_0*gamma)/S0 # Udtryk for R0 og isolere beta
## Simulation parameters
T <- floor(365/2)
dt <- (T/24)/30
nt <- T/dt
tv <- seq(0,T,dt)
## Output
S <- I <- R <- numeric(nt+1)
S[1] <- sum(X == 1)
I[1] <- sum(X == 2)
R[1] <- sum(X == 3)
## Main loop
for(i in 1:nt)
{
for(j in 1:N)
{
if(X[j] == 2) ## Let each "Infected" "Recover" with probability gamma*dt
{
if(runif(1) < gamma*dt) X[j] <- 3
}
if(X[j] == 1)
{
if(runif(1) < beta*I[i]*dt) X[j] <- 2
}
}
S[i+1] <- sum(X == 1)
I[i+1] <- sum(X == 2)
R[i+1] <- sum(X == 3)
}
## Plots
par(mfrow=c(1,2))
plot(tv,S,type="s",ylim=c(0,N),xlab="Time",ylab="S,R")
lines(tv,R,type="s")
plot(tv,I,type="s",xlab="Time",ylab="I")
N <- 1000  # Number of individuals in the population
I0 <- 1   # Initial number of infected
S0 <- N-I0 # Vi har ikke recovered endnu, så det er N pr. de syge
## Define state vector
X <- rep(1,N) # "1" codes "susceptible", "2" codes "infected", "3" codes "recovered"
X[1:I0] <- 2
## Model parameters
gamma <- 1
R_0 <- 2
beta <- (R_0*gamma)/S0 # Udtryk for R0 og isolere beta
## Simulation parameters
T <- floor(365/2)
dt <- (T/24)/30
nt <- T/dt
tv <- seq(0,T,dt)
## Output
S <- I <- R <- numeric(nt+1)
S[1] <- sum(X == 1)
I[1] <- sum(X == 2)
R[1] <- sum(X == 3)
## Main loop
for(i in 1:nt)
{
for(j in 1:N)
{
if(X[j] == 2) ## Let each "Infected" "Recover" with probability gamma*dt
{
if(runif(1) < gamma*dt) X[j] <- 3
}
if(X[j] == 1)
{
if(runif(1) < beta*I[i]*dt) X[j] <- 2
}
}
S[i+1] <- sum(X == 1)
I[i+1] <- sum(X == 2)
R[i+1] <- sum(X == 3)
dat=matrix(NA, nrow=10,ncol=200)
for(i in 1:10){
dat[i,]=arima.sim(model=list(ar=0.9,ma=c(2,0.5)),n=200,sd=0.2)
}
acf(dat[1,])
plot(dat[1,],type="l",col=colors[1],ylim=c(-5,5),main="The 10 simulated ARMA(1,2) models",ylab="Simulation value",xlab="Iteration")
lm=50
for(i in 2:10){
lines(dat[i,],type="l",col=colors[i])
}
acf1<-acf(dat[1,],plot=FALSE,lag.max = lm)
acf1$acf[,1,1]
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-0.5,1),type="l",col=colors[1],main="Blah")
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm)
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-0.5,1),type="l",col=colors[1],main="Autocorrelation funtion for the 10 simulations")
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm)
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
?acf
acf1<-acf(dat[1,],plot=FALSE,lag.max = lm)
acf1$acf[,1,1]
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-0.5,1),type="l",col=colors[1],main="Autocorrelation funtion for the 10 simulations")
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm)
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
plot(dat[1,],type="l")
pacf(dat[1,])
pacf1<-pacf(dat[1,],plot=FALSE,lag.max = lm)
pacf1$acf[,1,1]
plot(pacf1,xlim=c(.5,lm-.5),ylim=c(-.5,1),type="l",col=1)
for(i in 2:10){
pacftmp<-pacf(dat[i,],plot=FALSE,lag.max = lm)
lines(1:lm,pacftmp$acf[,1,1],col=i)
}
pacf1<-pacf(dat[1,],plot=FALSE,lag.max = lm,main="Partial autocorrelation funtion for the 10 simulations")
pacf1$acf[,1,1]
plot(pacf1,xlim=c(.5,lm-.5),ylim=c(-.5,1),type="l",col=1,main="Partial autocorrelation funtion for the 10 simulations")
for(i in 2:10){
pacftmp<-pacf(dat[i,],plot=FALSE,lag.max = lm)
lines(1:lm,pacftmp$acf[,1,1],col=i)
}
plot(pacf1,xlim=c(.5,lm-1),ylim=c(-.5,1),type="l",col=1,main="Partial autocorrelation funtion for the 10 simulations")
plot(pacf1,xlim=c(.5,lm-1.8),ylim=c(-.5,1),type="l",col=1,main="Partial autocorrelation funtion for the 10 simulations")
plot(pacf1,xlim=c(.5,lm-2),ylim=c(-.5,1),type="l",col=1,main="Partial autocorrelation funtion for the 10 simulations")
for(i in 2:10){
pacftmp<-pacf(dat[i,],plot=FALSE,lag.max = lm)
lines(1:lm,pacftmp$acf[,1,1],col=i)
}
avars=rep(NA,10)
for(i in 1:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm,type="covariance")
avars[i]<-acftmp$acf[1,1,1]
}
rm(list=ls())
par(mfrow=c(1,1))
set.seed(0)
colors=rainbow(10)
# Simulate 10 ARMA realisations (arima.sim(1,0,2))
dat=matrix(NA, nrow=10,ncol=200)
for(i in 1:10){
dat[i,]=arima.sim(model=list(ar=0.9,ma=c(2,0.5)),n=200,sd=0.2)
}
acf(dat[1,])
plot(dat[1,],type="l",col=colors[1],ylim=c(-5,5),main="The 10 simulated ARMA(1,2) models",ylab="Simulation value",xlab="Observation")
lm=50
for(i in 2:10){
lines(dat[i,],type="l",col=colors[i])
}
acf1<-acf(dat[1,],plot=FALSE,lag.max = lm)
acf1$acf[,1,1]
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-0.5,1),type="l",col=colors[1],main="Autocorrelation function for the 10 simulations")
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm)
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm)
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
plot(dat[1,],type="l")
pacf(dat[1,])
plot(dat[1,],type="l")
pacf(dat[1,])
pacf1<-pacf(dat[1,],plot=FALSE,lag.max = lm)
pacf1$acf[,1,1]
plot(pacf1,xlim=c(.5,lm-2),ylim=c(-.5,1),type="l",col=1,main="Partial autocorrelation function for the 10 simulations")
for(i in 2:10){
pacftmp<-pacf(dat[i,],plot=FALSE,lag.max = lm)
lines(1:lm,pacftmp$acf[,1,1],col=i)
}
avars=rep(NA,10)
for(i in 1:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm,type="covariance")
avars[i]<-acftmp$acf[1,1,1]
}
## Analytiske gammaer udregnet i maple.
g=rep(NA,lm+1)
g[1]<-2.412631579
g[2]<-2.309368421
g[3]<-2.098431579
for(i in 4:(lm+1)){
k=i-1
g[i]<-0.9^(k-2)*g[3]
}
acf1<-acf(dat[1,],plot=FALSE,lag.max = lm,type="covariance")
acf1$acf[,1,1]
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-1.3,2.5),type="l",col=colors[1])
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm,type="covariance")
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
points(0:50,g)
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-1.3,2.5),type="l",col=colors[1],main="Numerical and analytical autocovariance")
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm,type="covariance")
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
points(0:50,g)
legend(40,2,legend=c("Analytical autocovariance","Numerical autocovariance"),pch=c(1,NA),lty=c(1,NA))
legend(30,2,legend=c("Analytical autocovariance","Numerical autocovariance"),pch=c(1,NA),lty=c(1,NA))
legend(20,2,legend=c("Analytical autocovariance","Numerical autocovariance"),pch=c(1,NA),lty=c(1,NA))
legend(20,2,legend=c("Analytical autocovariance","Numerical autocovariance"),pch=c(1,NA),lty=c(NA,1))
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-1.3,2.5),type="l",col=colors[1],main="Numerical and analytical autocovariance")
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm,type="covariance")
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
points(0:50,g)
legend(20,2,legend=c("Analytical autocovariance","Numerical autocovariance"),pch=c(1,NA),lty=c(NA,1))
legend(20,2,legend=c("Analytical autocovariance","Numerical autocovariances"),pch=c(1,NA),lty=c(NA,1))
legend(25,2,legend=c("Analytical autocovariance","Numerical autocovariances"),pch=c(1,NA),lty=c(NA,1))
legend(25,2.2,legend=c("Analytical autocovariance","Numerical autocovariances"),pch=c(1,NA),lty=c(NA,1))
acf1<-acf(dat[1,],plot=FALSE,lag.max = lm,type="covariance")
acf1$acf[,1,1]
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-1.3,2.5),type="l",col=colors[1],main="Numerical and analytical autocovariance")
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm,type="covariance")
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
points(0:50,g)
legend(25,2.2,legend=c("Analytical autocovariance","Numerical autocovariances"),pch=c(1,NA),lty=c(NA,1))
plot(c(190,208,213,223,237,214,221,201,191,184,184,189,188,207,221,225),type="o",xlim=c(1,18),ylim=c(184,250),ylab="strøm i guess...")
points(c(17,18),c(232.6,210.65),col=2,pch=19)
points(c(5,6),c(237,214),col=3,pch=19)
points(c(17,17,18,18),c(232.6+c(-1,1)*qnorm(0.975)*7,210.65+c(-1,1)*qnorm(0.975)*sqrt(61.25)),col=2,pch=3)
qnorm(0.975)*7
qnorm(0.975)*sqrt(61.25)
legend(7,245,legend=c("Given Data","Predicted points","Prediction intervals","Last season in regard to predictions"),pch=c(1,NA),lty=c(NA,1))
legend(6,245,legend=c("Given Data","Predicted points","Prediction intervals","Last season in regard to predictions"),pch=c(1,NA),lty=c(NA,1))
legend(6,245,legend=c("Given Data","Predicted points","Prediction intervals","Last season in regard to predictions"),pch=c(1,NA,19,3,19),lty=c(NA,1))
legend(6,245,legend=c("Given Data","Predicted points","Prediction intervals","Last season in regard to predictions"),pch=c(1,NA,19,3,19),lty=c(1,1,NA,NA),col=c(1,2,2,3))
legend(6,245,legend=c("Given Data","Predicted points","Prediction intervals","Last season in regard to predictions"),pch=c(1,19,3,19),lty=c(1,NA,NA,NA),col=c(1,2,2,3))
plot(c(190,208,213,223,237,214,221,201,191,184,184,189,188,207,221,225),type="o",xlim=c(1,18),ylim=c(184,250),ylab="strøm i guess...")
points(c(17,18),c(232.6,210.65),col=2,pch=19)
points(c(5,6),c(237,214),col=3,pch=19)
points(c(17,17,18,18),c(232.6+c(-1,1)*qnorm(0.975)*7,210.65+c(-1,1)*qnorm(0.975)*sqrt(61.25)),col=2,pch=3)
legend(6,245,legend=c("Given Data","Predicted points","Prediction intervals","Last season in regard to predictions"),pch=c(1,19,3,19),lty=c(1,NA,NA,NA),col=c(1,2,2,3))
plot(c(190,208,213,223,237,214,221,201,191,184,184,189,188,207,221,225),type="o",xlim=c(1,18),ylim=c(184,250),ylab="combined electricity consumption (GWh)")
points(c(17,18),c(232.6,210.65),col=2,pch=19)
points(c(5,6),c(237,214),col=3,pch=19)
points(c(17,17,18,18),c(232.6+c(-1,1)*qnorm(0.975)*7,210.65+c(-1,1)*qnorm(0.975)*sqrt(61.25)),col=2,pch=3)
legend(6,245,legend=c("Given Data","Predicted points","Prediction intervals","Last season in regard to predictions"),pch=c(1,19,3,19),lty=c(1,NA,NA,NA),col=c(1,2,2,3))
plot(c(190,208,213,223,237,214,221,201,191,184,184,189,188,207,221,225),type="o",xlim=c(1,18),ylim=c(184,250),ylab="combined electricity consumption (GWh)",main="Prediction of seasonal AR model")
points(c(17,18),c(232.6,210.65),col=2,pch=19)
points(c(5,6),c(237,214),col=3,pch=19)
points(c(17,17,18,18),c(232.6+c(-1,1)*qnorm(0.975)*7,210.65+c(-1,1)*qnorm(0.975)*sqrt(61.25)),col=2,pch=3)
legend(6,245,legend=c("Given Data","Predicted points","Prediction intervals","Last season in regard to predictions"),pch=c(1,19,3,19),lty=c(1,NA,NA,NA),col=c(1,2,2,3))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
rm(list=ls())
par(mfrow=c(1,1))
set.seed(0)
colors=rainbow(10)
# Simulate 10 ARMA realisations (arima.sim(1,0,2))
dat=matrix(NA, nrow=10,ncol=200)
for(i in 1:10){
dat[i,]=arima.sim(model=list(ar=0.9,ma=c(2,0.5)),n=200,sd=0.2)
}
acf(dat[1,])
plot(dat[1,],type="l",col=colors[1],ylim=c(-5,5),main="The 10 simulated ARMA(1,2) models",ylab="Simulation value",xlab="Observation")
lm=50
for(i in 2:10){
lines(dat[i,],type="l",col=colors[i])
}
acf1<-acf(dat[1,],plot=FALSE,lag.max = lm)
acf1$acf[,1,1]
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-0.5,1),type="l",col=colors[1],main="Autocorrelation function for the 10 simulations")
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm)
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
##
plot(dat[1,],type="l")
pacf(dat[1,])
pacf1<-pacf(dat[1,],plot=FALSE,lag.max = lm)
pacf1$acf[,1,1]
plot(pacf1,xlim=c(.5,lm-2),ylim=c(-.5,1),type="l",col=1,main="Partial autocorrelation function for the 10 simulations")
for(i in 2:10){
pacftmp<-pacf(dat[i,],plot=FALSE,lag.max = lm)
lines(1:lm,pacftmp$acf[,1,1],col=i)
}
avars=rep(NA,10)
for(i in 1:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm,type="covariance")
avars[i]<-acftmp$acf[1,1,1]
}
## Analytiske gammaer udregnet i maple.
g=rep(NA,lm+1)
g[1]<-2.412631579
g[2]<-2.309368421
g[3]<-2.098431579
for(i in 4:(lm+1)){
k=i-1
g[i]<-0.9^(k-2)*g[3]
}
SIR_p2 <- c(beta = beta, gamma = gamma, delta = delta)
SIR_y <- c(S = S0, I = I0, R = 0)
SIRsol2 <-  as.data.frame(ode(y = SIR_y, times = tv, func = SIRmodel2, parms = SIR_p2))
## Plots
par(mfrow=c(1,2))
plot(tv,S,type="s",ylim=c(0,N),xlab="Time",ylab="S,R")
lines(tv,R,type="s")
lines(tv, SIRsol2$R, col = 2)
plot(tv,I,type="s",xlab="Time",ylab="I")
lines(tv, SIRsol2$I, col = 2)
Istar <- 45.90909 # sidste entry fra I fra ode solution
Sstar <- gamma/beta
J <- matrix(c(-beta*Istar-delta, -beta*Sstar-delta, Istar*beta, 0), nrow = 2, byrow = TRUE)
eigen(J)
library(GGally)
install.packages("GGally")
?ggpairs
library(GGally)
library(ggplot2)
library(GGally)
?ggpairs
library(tidyverse)
install.packages("tidyverse")
setwd("~/Downloads/Archive")
Data <- read.csv("DistrictHeatingTestSample.csv", header=TRUE, sep=";")
names(Data)[1] <- "StartDateTime"
GGally::ggpairs(Data[,-1])
Data$StartDateTime
par(mfrow=c(1,1))
plot(Data$Flow)
# Sun pairs
GGally::ggpairs(day.weather[c('SunHour','Condition','UltravioletIndex','Radiation')])
source('~/Dropbox/DTU/6. semester/Bachelorprojekt F19/Bachelor/scripts/data.R', echo=TRUE)
source("data.R")
source("BBR.R")
library(ggplot2)
library(gridExtra)
library(tidyverse)
# Watts colors
Wcol=c(1,rgb(132,202,41,maxColorValue = 255),rgb(231,176,59,maxColorValue = 255),rgb(229,56,50,maxColorValue = 255))
# Example using Watts colors
plot(data[[1]]$Flow,col=Wcol[2])
avgconsumption<-rep(0,difftime(max(EndDays),min(StartDays), units ="hours"))
weightavg<-rep(0,difftime(max(EndDays),min(StartDays), units ="hours"))
difftime(max(EndDays),min(StartDays), units ="hours")
avgconsumption[difftime(max(EndDays),min(StartDays), units ="hours")]
difftime(StartDays[1],min(StartDays), units ="hours")
difftime(EndDays[1],min(StartDays), units ="hours")
# Investigating pairs plots
day.tmp <- day.weather[(day.weather$Date <= as.Date(day.avg$Date[1],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(tail(day.avg$Date,1),tz="GMT"),]
# Sun pairs
GGally::ggpairs(day.weather[c('SunHour','Condition','UltravioletIndex','Radiation')])
acf1<-acf(dat[1,],plot=FALSE,lag.max = lm,type="covariance")
acf1$acf[,1,1]
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-1.3,2.5),type="l",col=colors[1],main="Numerical and analytical autocovariance")
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm,type="covariance")
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
points(0:50,g)
legend(25,2.2,legend=c("Analytical autocovariance","Numerical autocovariances"),pch=c(1,NA),lty=c(NA,1))
## Q2.2
plot(c(190,208,213,223,237,214,221,201,191,184,184,189,188,207,221,225),type="o",xlim=c(1,18),ylim=c(184,250),ylab="combined electricity consumption (GWh)",main="Prediction of seasonal AR model")
points(c(17,18),c(232.6,210.65),col=2,pch=19)
points(c(5,6),c(237,214),col=3,pch=19)
points(c(17,17,18,18),c(232.6+c(-1,1)*qnorm(0.975)*7,210.65+c(-1,1)*qnorm(0.975)*sqrt(61.25)),col=2,pch=3)
legend(6,245,legend=c("Given Data","Predicted points","Prediction intervals","Last season in regard to predictions"),pch=c(1,19,3,19),lty=c(1,NA,NA,NA),col=c(1,2,2,3))
## Q2.3
#model 1
ARMA<- arima.sim(n=200,list(order=c(1,0,0),ar=-0.85))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,0) seasonal model, with S=12")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(12,0,0),ar=c(rep(0,11),0.8)))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (0,0,0)x(1,0,0) seasonal model, with S=12")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(1,0,12),ar=0.8,ma=c(rep(0,11),0.7)))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(0,0,1) seasonal model, with S=12")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(13,0,0),ar=c(0.7,rep(0,10),-0.8,0.56)))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (1,0,0)x(1,0,0) seasonal model, with S=12")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
#model 5
ARMA<- arima.sim(n=200,list(order=c(14,0,0),ar=c(-0.6,-0.6,rep(0,9),-0.8,-0.48,-0.48)))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (2,0,0)x(1,0,0) seasonal model, with S=12")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
ARMA<- arima.sim(n=200,list(order=c(0,0,13),ma=c(-0.7,rep(0,10),0.8,-0.56)))
layout(matrix(c(1,1,2,3),2,2,byrow=TRUE),widths=c(1,1),heights = c(1,1))
plot(ARMA,type="l",col=1,ylim=c(-6,6),ylab="Process values",xlab="Time",main="Plot of a (0,0,1)x(0,0,1) seasonal model, with S=12")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
pacf(ARMA,main="",lag.max=50,panel.first=c(abline(v=(1:4)*12,col=2,lty=2)))
rm(list=ls())
par(mfrow=c(1,1))
set.seed(0)
colors=rainbow(10)
# Simulate 10 ARMA realisations (arima.sim(1,0,2))
dat=matrix(NA, nrow=10,ncol=200)
for(i in 1:10){
dat[i,]=arima.sim(model=list(ar=0.9,ma=c(2,0.5)),n=200,sd=0.2)
}
acf(dat[1,])
plot(dat[1,],type="l",col=colors[1],ylim=c(-5,5),main="The 10 simulated ARMA(1,2) models",ylab="Simulation value",xlab="Observation")
lm=50
for(i in 2:10){
lines(dat[i,],type="l",col=colors[i])
}
acf1<-acf(dat[1,],plot=FALSE,lag.max = lm)
acf1$acf[,1,1]
plot(acf1,xlim=c(-.5,lm-2),ylim=c(-0.5,1),type="l",col=colors[1],main="Autocorrelation function for the 10 simulations")
for(i in 2:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm)
lines(0:lm,acftmp$acf[,1,1],col=colors[i])
}
##
plot(dat[1,],type="l")
pacf(dat[1,])
pacf1<-pacf(dat[1,],plot=FALSE,lag.max = lm)
pacf1$acf[,1,1]
plot(pacf1,xlim=c(.5,lm-2),ylim=c(-.5,1),type="l",col=1,main="Partial autocorrelation function for the 10 simulations")
for(i in 2:10){
pacftmp<-pacf(dat[i,],plot=FALSE,lag.max = lm)
lines(1:lm,pacftmp$acf[,1,1],col=i)
}
avars=rep(NA,10)
for(i in 1:10){
acftmp<-acf(dat[i,],plot=FALSE,lag.max = lm,type="covariance")
avars[i]<-acftmp$acf[1,1,1]
}
avars
acf(log(tab$NO2[train]),lag.max = 200)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
par(mar=c(3,3,2,1), mgp=c(2,0.7,0))
source("data.R")
source("stepP.R")
source("BSplines.R")
library(foreach)
library(doParallel)
# setup parallel
cores = detectCores()
# Defining new data set where the summer period is left out
model.data <- weatherCons
for (i in 1:n)
{
model.data[[i]]$Date <- NULL
model.data[[i]]$PrecipitationProbability <- NULL
model.data[[i]]$SunHour <- NULL
}
lmMultiple <- vector(mode="list", length = n)
for (i in 1:n) {
print(paste('Modelling house ',i))
model.tmp <- model.data[[i]]
model.tmp <- model.tmp[model.tmp$Temperature <= 12,]
Splinebasis <- BSplines(model.tmp$WindDirection)
lmMultiple[[i]] <- stepP(lm(Consumption ~ Temperature*I(WindSpeed*Splinebasis)+(.-UltravioletIndex-WindSpeed)^2, data = model.tmp))
}
#
summary(lmMultiple[[60]]$object)
par(mfrow=c(2,2))
for (i in 1:n)
{
plot(lmMultiple[[i]]$object)
}
#
# plot(Consumption~Temperature,data=model.tmp)
# lines(lmMultiple$object)
# #
# # plot(lmMultiple[[1]])
# par(mfrow = c(2,2))
# plot(lm.multiple)
#
# plot(lmMultiple[[1]])
c <- makeCluster(cores[1]-1)
registerDoParallel(c)
lmMultiple <- foreach(i=1:n) %dopar% {
print(paste('Modelling house ',i))
model.tmp <- model.data[[i]]
model.tmp <- model.tmp[model.tmp$Temperature <= 12,]
Splinebasis <- BSplines(model.tmp$WindDirection)
MultiModel <- stepP(lm(Consumption ~ Temperature*WindSpeed*Splinebasis+(.-UltravioletIndex)^2, data = model.tmp))
MultiModel
}
install.packages("doParallel")
install.packages("foreach")
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
par(mar=c(3,3,2,1), mgp=c(2,0.7,0))
source("data.R")
source("stepP.R")
source("BSplines.R")
library(foreach)
library(doParallel)
# setup parallel
cores = detectCores()
# Defining new data set where the summer period is left out
model.data <- weatherCons
for (i in 1:n)
{
model.data[[i]]$Date <- NULL
model.data[[i]]$PrecipitationProbability <- NULL
model.data[[i]]$SunHour <- NULL
}
lmMultiple <- vector(mode="list", length = n)
for (i in 1:n) {
print(paste('Modelling house ',i))
model.tmp <- model.data[[i]]
model.tmp <- model.tmp[model.tmp$Temperature <= 12,]
Splinebasis <- BSplines(model.tmp$WindDirection)
lmMultiple[[i]] <- stepP(lm(Consumption ~ Temperature*I(WindSpeed*Splinebasis)+(.-UltravioletIndex-WindSpeed)^2, data = model.tmp))
}
install.packages("pbs")
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
par(mar=c(3,3,2,1), mgp=c(2,0.7,0))
source("data.R")
source("stepP.R")
source("BSplines.R")
library(foreach)
library(doParallel)
# setup parallel
cores = detectCores()
# Defining new data set where the summer period is left out
model.data <- weatherCons
for (i in 1:n)
{
model.data[[i]]$Date <- NULL
model.data[[i]]$PrecipitationProbability <- NULL
model.data[[i]]$SunHour <- NULL
}
lmMultiple <- vector(mode="list", length = n)
for (i in 1:n) {
print(paste('Modelling house ',i))
model.tmp <- model.data[[i]]
model.tmp <- model.tmp[model.tmp$Temperature <= 12,]
Splinebasis <- BSplines(model.tmp$WindDirection)
lmMultiple[[i]] <- stepP(lm(Consumption ~ Temperature*I(WindSpeed*Splinebasis)+(.-UltravioletIndex-WindSpeed)^2, data = model.tmp))
}
version
if(!require(installr)) {
install.packages("installr");
require(installr)
}
updateR()
