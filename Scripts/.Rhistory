model.tmp$South <- tmp.wind[,1]
model.tmp$West <- tmp.wind[,2]
lmMultipleFull[[i]] <- lm(Consumption ~ Temperature*(North + East + South + West)+MeanSeaLevelPressure+Radiation+AutumnBreak+ChristmasBreak+Weekend, data = model.tmp)
# Checking model assumptions
par(mfrow = c(2,2), mar = c(3,3,3,1) + 0.1)
plot(lmMultipleFull[[i]])
title(paste("Daily consumption for house ", i, "using multiple lm"), outer=TRUE, adj = 0.5, line = -1.25)
# Testing for normality
s.test[[i]] <- shapiro.test(lmMultipleFull[[i]]$residuals)
print(s.test[[i]]$p.value)
lmFull_est_S[match(i,Short),] <- summary(lmMultipleFull[[i]])$coefficients[,1]
lmFull_p_S[match(i,Short),] <- summary(lmMultipleFull[[i]])$coefficients[,4]
}
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
par(mar=c(3,3,2,1), mgp=c(2,0.7,0))
source("data.R")
s.test <- vector(mode = "list", length = n)
lm.simple <- vector(mode = "list", length = n)
model.data <- weatherCons
for (i in 1:n) {
model.tmp <- model.data[[i]]
model.tmp <- model.tmp[model.tmp$Temperature <= 12,]
lm.simple[[i]] <- lm(Consumption ~ Temperature, data = model.tmp)
print(summary(lm.simple[[i]]))
# Checking model assumptions
par(mfrow = c(2,2), mar = c(3,3,3,1) + 0.1)
plot(lm.simple[[i]])
title(paste("Daily consumption for house ", i, "using simple lm"), outer=TRUE, adj = 0.5, line = -1.25)
# Testing for normality
s.test[[i]] <- shapiro.test(lm.simple[[i]]$residuals)
print(s.test[[i]]$p.value)
}
for (i in 1:n) {
model.tmp <- model.data[[i]]
model.tmp <- model.tmp[model.tmp$Temperature <= 12,]
lm.simple[[i]] <- lm(Consumption ~ Temperature, data = model.tmp)
#print(summary(lm.simple[[i]]))
# Checking model assumptions
par(mfrow = c(2,2), mar = c(3,3,3,1) + 0.1)
plot(lm.simple[[i]])
title(paste("Daily consumption for house ", i, "using simple lm"), outer=TRUE, adj = 0.5, line = -1.25)
# Testing for normality
s.test[[i]] <- shapiro.test(lm.simple[[i]]$residuals)
print(s.test[[i]]$p.value)
}
for (i in 1:n) {
print(paste('Modeling house ',i))
model.tmp <- model.data[[i]]
model.tmp <- model.tmp[model.tmp$Temperature <= 12,]
lm.simple[[i]] <- lm(Consumption ~ Temperature, data = model.tmp)
#print(summary(lm.simple[[i]]))
# Checking model assumptions
par(mfrow = c(2,2), mar = c(3,3,3,1) + 0.1)
plot(lm.simple[[i]])
title(paste("Daily consumption for house ", i, "using simple lm"), outer=TRUE, adj = 0.5, line = -1.25)
# Testing for normality
s.test[[i]] <- shapiro.test(lm.simple[[i]]$residuals)
print(s.test[[i]]$p.value)
}
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
par(mar=c(3,3,2,1), mgp=c(2,0.7,0),mfrow=c(1,1),xpd=FALSE)
source("data.R")
source("stepP.R")
source("BSplines.R")
source("CircleCol.R")
# Initializing vectors containing "long" and "short" houses
k <-1:n
Long <- k[Datalengths>=360]
Short <- k[Datalengths<360]
# Defining data used for modeling
model.data <- weatherCons
# Various attributes are removed
for (i in 1:n)
{
model.data[[i]]$Date <- NULL
model.data[[i]]$PrecipitationProbability <- NULL
model.data[[i]]$SunHour <- NULL
model.data[[i]]$UltravioletIndex <- NULL
model.data[[i]]$Condition <- NULL
}
GGally::ggpairs(day.avg[c('Date','Energy','Flow','Volume','TemperatureIn','TemperatureOut','CoolingDegree','Consumption')])
?ggpairs
GGally::ggpairs(c(day.avg['Consumption'], day.tmp[c('Date','Temperature','WindSpeed','WindDirection','SunHour','Condition','MeanSeaLevelPressure','DewPoint','PrecipitationProbability')]))
source("data.R")
# Watts colors
Wcol=c(1,rgb(132,202,41,maxColorValue = 255),rgb(231,176,59,maxColorValue = 255),rgb(229,56,50,maxColorValue = 255))
# Example using Watts colors
plot(data[[1]]$Flow,col=Wcol[2])
avgconsumption<-rep(0,difftime(max(EndDays),min(StartDays), units ="hours"))
weightavg<-rep(0,difftime(max(EndDays),min(StartDays), units ="hours"))
difftime(max(EndDays),min(StartDays), units ="hours")
avgconsumption[difftime(max(EndDays),min(StartDays), units ="hours")]
difftime(StartDays[1],min(StartDays), units ="hours")
difftime(EndDays[1],min(StartDays), units ="hours")
# Investigating pairs plots
day.tmp <- day.weather[(day.weather$Date <= as.Date(day.avg$Date[1],tz="GMT")),]
day.tmp <- day.tmp[day.tmp$Date >= as.Date(tail(day.avg$Date,1),tz="GMT"),]
# House pairs
par(mar=c(3,3,2,1), mgp=c(2,0.7,0))
pairs(day.avg[c('Date','Energy','Flow','Volume','TemperatureIn','TemperatureOut','CoolingDegree','Consumption')])
GGally::ggpairs(day.avg[c('Date','Energy','Flow','Volume','TemperatureIn','TemperatureOut','CoolingDegree','Consumption')])
# Weather pairs
par(mar=c(3,3,2,1), mgp=c(2,0.7,0))
pairs(c(day.avg['Consumption'], day.tmp[c('Date','Temperature','WindSpeed','WindDirection','SunHour','Condition','MeanSeaLevelPressure','DewPoint','PrecipitationProbability')]))
GGally::ggpairs(c(day.avg['Consumption'], day.tmp[c('Date','Temperature','WindSpeed','WindDirection','SunHour','Condition','MeanSeaLevelPressure','DewPoint','PrecipitationProbability')]))
# Combining the two dataframes to a single one
tmp.dat <-data.frame(tmp.d1[,-c(5,14)],SunHour = tmp.d2[,2],Obs=tmp.d2[,3])
# Combining Radiation with sunhour
tmp.dat$Radiation <- tmp.dat$SunHour*tmp.dat$Radiation
day.weather <-tmp.dat
# Switching the rows, such that the newest days are first
day.weather <- day.weather[dim(day.weather)[1]:1,]
# WindSpeed and WindDirection transformed to a daily average.
tmp.rekt <- matrix(data=rep(0,length(weather$ObsTime)*2),ncol=2)
pairs(day.avg[c('Consumption', 'Flow','Volume','TemperatureIn','TemperatureOut','CoolingDegree')])
ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point()
library(ggplot2)
ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point()
ggplot(data = day.avg, aes(x = c(Flow,Volume), y= Consumption)) + geom_point()
+ geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
+ geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")# Weather pairs
par(mfrow = c(3,3))
ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point()
+ geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
ggplot(data = day.avg, aes(x = Volume, y= Consumption)) + geom_point()
+ geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
ggplot(data = day.avg, aes(x = TemperatureIn, y= Consumption)) + geom_point()
+ geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
par(mfrow = c(2,3))
plot1 <- ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point()
+ geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot1 <- ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point()
plot2 <- ggplot(data = day.avg, aes(x = Volume, y= Consumption)) + geom_point()
plot3 <- ggplot(data = day.avg, aes(x = TemperatureIn, y= Consumption)) + geom_point()
plot4 <- ggplot(data = day.avg, aes(x = TemperatureOut, y= Consumption)) + geom_point()
plot5 <- ggplot(data = day.avg, aes(x = CoolingDegree, y= Consumption)) + geom_point()
plot5 <- ggplot(data = day.avg, aes(x = CoolingDegree, y= Consumption)) + geom_point()
grid.arrange(plot1, plot2, plot3, plot4, plot5, nrow = 2)
library(gridExtra)
par(mfrow = c(2,3))
plot1 <- ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point()
+ geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot2 <- ggplot(data = day.avg, aes(x = Volume, y= Consumption)) + geom_point()
+ geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot3 <- ggplot(data = day.avg, aes(x = TemperatureIn, y= Consumption)) + geom_point()
+ geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot4 <- ggplot(data = day.avg, aes(x = TemperatureOut, y= Consumption)) + geom_point()
+ geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot5 <- ggplot(data = day.avg, aes(x = CoolingDegree, y= Consumption)) + geom_point()
+ geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
grid.arrange(plot1, plot2, plot3, plot4, plot5, nrow = 2)
par(mfrow = c(2,3))
plot1 <- ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot2 <- ggplot(data = day.avg, aes(x = Volume, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot3 <- ggplot(data = day.avg, aes(x = TemperatureIn, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot4 <- ggplot(data = day.avg, aes(x = TemperatureOut, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot5 <- ggplot(data = day.avg, aes(x = CoolingDegree, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
grid.arrange(plot1, plot2, plot3, plot4, plot5, nrow = 2)
par(mfrow = c(2,3))
plot1 <- ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot2 <- ggplot(data = day.avg, aes(x = Volume, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot3 <- ggplot(data = day.avg, aes(x = TemperatureIn, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot4 <- ggplot(data = day.avg, aes(x = TemperatureOut, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot5 <- ggplot(data = day.avg, aes(x = CoolingDegree, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
grid.arrange(plot1, plot2, plot3, plot4, plot5, nrow = 5)
par(mfrow = c(2,3))
plot1 <- ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot2 <- ggplot(data = day.avg, aes(x = Volume, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot3 <- ggplot(data = day.avg, aes(x = TemperatureIn, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot4 <- ggplot(data = day.avg, aes(x = TemperatureOut, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
plot5 <- ggplot(data = day.avg, aes(x = CoolingDegree, y= Consumption)) + geom_point() + geom_smooth(col=Wcol[2], se = T) + ylab("Consumption")
grid.arrange(plot1, plot2, plot3, plot4, plot5, nrow = 2, ncol = 3)
plot1 <- ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point() + ylab("Consumption")
grid.arrange(plot1, plot2, plot3, plot4, plot5, nrow = 2, ncol = 3)
plot1 <- ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point() + ylab("Consumption")
plot2 <- ggplot(data = day.avg, aes(x = Volume, y= Consumption)) + geom_point() + ylab("Consumption")
plot3 <- ggplot(data = day.avg, aes(x = TemperatureIn, y= Consumption)) + geom_point() + ylab("Consumption")
plot4 <- ggplot(data = day.avg, aes(x = TemperatureOut, y= Consumption)) + geom_point() + ylab("Consumption")
plot5 <- ggplot(data = day.avg, aes(x = CoolingDegree, y= Consumption)) + geom_point() + ylab("Consumption")
grid.arrange(plot1, plot2, plot3, plot4, plot5, nrow = 2, ncol = 3)
plot6 <- ggplot(data = c(day.avg,day.tmp), aes(x = day.tmp[Windspeed], y= Consumption)) + geom_point() + ylab("Consumption")
plot6 <- ggplot(aes(x = day.tmp[Windspeed], y= day.avg[Consumption])) + geom_point() + ylab("Consumption")
plot6 <- ggplot(data = day.tmp, aes(x = Windspeed, y= day.avg[Consumption])) + geom_point() + ylab("Consumption")
plot6
plot6 <- ggplot(data = day.tmp, aes(x = Windspeed, y= Consumption)) + geom_point() + ylab("Consumption")
plot6
plot6 <- ggplot(data = day.tmp, aes(x = WindSpeed, y= Consumption)) + geom_point() + ylab("Consumption")
plot6
day.tmp$Consumption <- day.avg$Consumption
plot6 <- ggplot(data = day.tmp, aes(x = WindSpeed, y= Consumption)) + geom_point() + ylab("Consumption")
plot6
weather[[1]]$PrecipitationProbability
# Sources and packages
source("DataChecking.R")
source("Polarize.R")
source("Sun.R")
library(xts)
library(solaR)
# Watts colorscheme
Wcol=c(1,rgb(132,202,41,maxColorValue = 255),rgb(231,176,59,maxColorValue = 255),rgb(229,56,50,maxColorValue = 255))
# Loading all data
data.path = "../Consumption data/"
file.names <- dir(data.path, pattern =".csv")
n <- length(file.names)
Datalengths = rep(1,nrow=n)
data <- vector(mode="list", length = n)
day.data <- vector(mode="list", length = n)
data.key <- rep("",n)
# Saving a specific saturday and sunday for the attribute "Weekend"
Weekend=weekdays(as.POSIXlt(c(as.Date('2019-01-26'),as.Date('2019-01-27')),format = "%Y-%m-%d", tz = "GMT"),abbreviate = TRUE)
sat<-substring(Weekend[1],1:2,1:2)
sun<-substring(Weekend[2],1:2,1:2)
# Loading a single table to initialize dates
dt.tmp <- read.table(paste(data.path,file.names[1], sep = ""), sep=";", stringsAsFactors=FALSE, header = TRUE, dec=',')
names(dt.tmp)[1] = 'StartDateTime'
StartDays <- strptime(dt.tmp$EndDateTime[1:n], format = "%d-%m-%Y %H:%M:%S", tz = "GMT")
EndDays <- strptime(dt.tmp$EndDateTime[1:n], format = "%d-%m-%Y %H:%M:%S", tz = "GMT")
# saving the number of data-set is used.
k <- 0;
# Big for-loop for loading data.
for(i in 1:n){
dt.tmp <- read.table(paste(data.path,file.names[i], sep = ""), sep=";", stringsAsFactors=FALSE, header = TRUE, dec=',')
# removing weird NA attribute.
dt.tmp$X <- NULL
# Using "EndTime" as "ObsTime" and dropping "StartTime"
dt.tmp <- dt.tmp[,-1]
names(dt.tmp)[1]="ObsTime"
dt.tmp$ObsTime <- strptime(dt.tmp$ObsTime, format = "%d-%m-%Y %H:%M:%S", tz = "GMT")
# Removing data before startdate of weather data
#while(as.POSIXlt(x="2017-12-31 23:00:00",tz="GMT", format = "%Y-%m-%d %H:%M:%S")>=dt.tmp$ObsTime[length(dt.tmp$ObsTime)]){
#  dt.tmp<-dt.tmp[1:(length(dt.tmp$ObsTime)-1),]
#}
# Add logical vairable for weekends
tmp.wd <- as.Date(dt.tmp$ObsTime,tz="GMT")
tmp.wd <-weekdays(tmp.wd,abbreviate = TRUE)
dt.tmp$Weekend <- grepl(intersect(sat,sun),tmp.wd)
#Make a copy before adding NA's.
dt.tmp.noNA<- dt.tmp
# Fill missing null values.
tmp.xts <- xts(dt.tmp[,-1], order.by=dt.tmp[,1])
t1<-rev(seq(from=(tail(dt.tmp$ObsTime,n=1)-hour(tail(dt.tmp$ObsTime,n=1))*60*60), to=(dt.tmp$ObsTime[1]+(23-hour(dt.tmp$ObsTime[1]))*60*60), by="hour"))
d1 <- xts(rep(1,length(t1)), order.by=t1)
x <- merge(d1,tmp.xts,all=TRUE)
tmp.df <- data.frame(ObsTime=index(x),coredata(x[,-1]))
dt.tmp <- tmp.df[dim(tmp.df)[1]:1,]
# Setting parameters for data checking
par = c('min_obs'=1000, 'miss_fraction'=1/20)
# If the data check is ok, store that data set
if (DataChecking(dt.tmp,par)==TRUE)
{
# Keep track of the amount stored datasets.
k=k+1
data[[k]] <- dt.tmp
#Making daily data
tmp.dat <- dt.tmp.noNA
tmp.dat$ObsTime <- as.Date(tmp.dat$ObsTime,tz="GMT")
tmp.dat$Obs <- rep(1,length(tmp.dat$ObsTime))
tmp.d1 <-aggregate(x=tmp.dat[,-1],by= data.frame(Date = tmp.dat[,1]),FUN = mean)
tmp.d2 <-aggregate(x=tmp.dat[,9],by= data.frame(Date = tmp.dat[,1]),FUN = sum)
tmp.dat <-data.frame(tmp.d1[,-9],Obs=tmp.d2[,2])
# Fill missing null values.
tmp.xts <- xts(tmp.dat[,-1], order.by=tmp.dat[,1])
t1<-rev(seq(from=tmp.dat$Date[1], to=tail(tmp.dat$Date,n=1), by="day"))
d1 <- xts(rep(1,length(t1)), order.by=t1)
x <- merge(d1,tmp.xts,all=TRUE)
tmp.df <- data.frame(Date=index(x),coredata(x[,-1]))
tmp.dat <- tmp.df[dim(tmp.df)[1]:1,]
day.data[[k]] <-tmp.dat
data.key[k]<-substr(file.names[i],1,36)
}
}
#removing unused allocated spaces.
if (k<n){
data<-data[-(k+1:n)]
day.data<-day.data[-(k+1:n)]
data.key<-data.key[-(k+1:n)]
Datalengths<-Datalengths[-(k+1:n)]
}
# k is new n
n <- k
#Removing Feb data to get rid of NA
jan1<-day.data[[1]]$Date[1]
for(i in 1:n){
while(day.data[[i]]$Date[1]>jan1){
day.data[[i]]<-day.data[[i]][-1,]
}
# Saving the amount of observations in each table (with NA's).
Datalengths[i]=length(day.data[[i]]$Date)
# Setting start and end times for each table.
EndDays[i]= day.data[[i]]$Date[1]
StartDays[i]=day.data[[i]]$Date[length(day.data[[i]]$Date)]
}
#Removing Feb data from hour data
jan1<-data[[1]]$ObsTime[1]
for(i in 1:n){
while(data[[i]]$ObsTime[1]>jan1){
data[[i]]<-data[[i]][-1,]
}
}
# Reading weather data
weather <- read.table('../WeatherData_01-01-2018_02-06-2019.csv', sep=";", stringsAsFactors=FALSE, header = TRUE, dec=',')
names(weather)[1]="ObsTime"
weather$ObsTime = strptime(weather$ObsTime,format='%d-%m-%Y %H:%M:%S',tz = 'GMT')
weather$IsHistoricalEstimated=weather$IsHistoricalEstimated=="True"
weather$X <- NULL
weather$Radiation <- Sun(weather$ObsTime[1],tail(weather$ObsTime,n=1))
# Removing the attribute UltraVioletIndex
weather$UltraVioletIndex <- NULL
weather[[1]]$PrecipitationProbability
weather[[18]]$PrecipitationProbability
weather$PrecipitationProbability
plot6 <- ggplot(data = day.tmp, aes(x = Temperature, y= Consumption)) + geom_point() + ylab("Consumption")
plot7 <- ggplot(data = day.tmp, aes(x = WindSpeed, y= Consumption)) + geom_point() + ylab("Consumption")
plot8 <- ggplot(data = day.tmp, aes(x = WindDirection, y= Consumption)) + geom_point() + ylab("Consumption")
plot9 <- ggplot(data = day.tmp, aes(x = MeanSeaLevelPressure, y= Consumption)) + geom_point() + ylab("Consumption")
plot10 <- ggplot(data = day.tmp, aes(x = DewPoint, y= Consumption)) + geom_point() + ylab("Consumption")
grid.arrange(plot6, plot7, plot8, plot9, plot10, nrow = 2, ncol = 3)
plot1 <- ggplot(data = day.avg, aes(x = Flow, y= Consumption)) + geom_point() + ylab("Consumption")
plot2 <- ggplot(data = day.avg, aes(x = Volume, y= Consumption)) + geom_point() + ylab("Consumption")
plot3 <- ggplot(data = day.avg, aes(x = TemperatureIn, y= Consumption)) + geom_point() + ylab("Consumption")
plot4 <- ggplot(data = day.avg, aes(x = TemperatureOut, y= Consumption)) + geom_point() + ylab("Consumption")
plot5 <- ggplot(data = day.avg, aes(x = CoolingDegree, y= Consumption)) + geom_point() + ylab("Consumption")
grid.arrange(plot1, plot2, plot3, plot4, plot5, nrow = 2, ncol = 3)
grid.arrange(plot1, plot2, plot3, plot4, plot5, nrow = 2, ncol = 3, main = "hej")
?grid.arrange
grid.arrange(plot1, plot2, plot3, plot4, plot5, nrow = 2, ncol = 3)
grid.arrange(plot1, plot2, plot3, plot4, plot5, nrow = 3, ncol = 2)
plot6 <- ggplot(data = day.tmp, aes(x = Temperature, y= Consumption)) + geom_point() + ylab("Consumption")
plot7 <- ggplot(data = day.tmp, aes(x = WindSpeed, y= Consumption)) + geom_point() + ylab("Consumption")
plot8 <- ggplot(data = day.tmp, aes(x = WindDirection, y= Consumption)) + geom_point() + ylab("Consumption")
plot9 <- ggplot(data = day.tmp, aes(x = MeanSeaLevelPressure, y= Consumption)) + geom_point() + ylab("Consumption")
plot10 <- ggplot(data = day.tmp, aes(x = DewPoint, y= Consumption)) + geom_point() + ylab("Consumption")
grid.arrange(plot6, plot7, plot8, plot9, plot10, nrow = 3, ncol = 2)
source("data.R")
# Investigating BBR data --------------------------------------------------
ggplot(data = BBR, aes(x = HouseType)) + geom_histogram()
# Investigating BBR data --------------------------------------------------
ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram()
BBR$TotalArea
BBR$HouseType
# Investigating BBR data --------------------------------------------------
ggplot(data = BBR, aes(x = "Parcel")) + geom_histogram()
# Investigating BBR data --------------------------------------------------
HouseType <- c(BBR$HouseType)
HouseType
# Investigating BBR data --------------------------------------------------
HouseType <- data.frame(c(BBR$HouseType))
plot11 <- ggplot(data = HouseType, aes(x = HouseType)) + geom_histogram()
plot11
plot11 <- ggplot(data = HouseType, aes(x = HouseType)) + geom_histogram(aes(y=..count../sum(..count..)))
plot11
# Investigating BBR data --------------------------------------------------
HouseType <- c(BBR$HouseType)
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(aes(y=..count../sum(..count..)))
plot11
# Investigating BBR data --------------------------------------------------
HouseType <- c(BBR$HouseType)
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(aes(y=..count../sum(..count..)))
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram()
plot11
# HouseType into continous variable
BBR$HouseType == "Parcel" <- 1
# HouseType into continous variable
BBR$HouseType[BBR$HouseType == "Parcel"] <- 1
# Loading BBR data, and sorting it with the key.
tmp.df<-data.frame(Key=data.key)
BBR.tmp <- read.table('../BBRdata.csv', sep=";", stringsAsFactors=FALSE, header = TRUE, dec=',')
BBR <- merge(tmp.df,BBR.tmp)
# HouseType into continous variable
BBR$HouseType <- as.factor(BBR$HouseType)
BBR$HouseType
source("data.R")
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram()
# Investigating BBR data --------------------------------------------------
HouseType <- c(BBR$HouseType)
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram()
plot11
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 30)
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 30))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 10))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 1))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 5))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 1))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 10))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 5))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 1))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 6))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 5))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(binwidth = 1))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 10))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 8))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 6))
(plot11 <- ggplot(data = BBR, aes(x = HouseType)) + geom_histogram(bins = 25))
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 25)
grid.arrange(plot11, plot12)
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 25)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 25)
grid.arrange(plot11, plot12)
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 10)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 10)
grid.arrange(plot11, plot12)
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 15)
plot13 <- ggplot(data = BBR, aes(x = ConstructionYear)) + geom_histogram(bins = 15)
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 15)
plot13 <- ggplot(data = BBR, aes(x = ConstructionYear)) + geom_histogram(bins = 15)
plot14 <- ggplot(data = BBR, aes(x = ReconstructionYear)) + geom_histogram(bins = 15)
grid.arrange(plot11, plot12, plot13, plot14, nrow = 2, ncol = 2)
?ggplot
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = c(0.7, 0.2),
legend.direction = "horizontal")
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = c(0.7, 0.2),
legend.direction = "horizontal"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = c(0.7, 0.2),
legend.direction = "horizontal")) + scale_fill_discrete(name = "House type", labels = c("A", "B", "C"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + scale_fill_discrete(name = "House type", labels = c("A", "B", "C"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + scale_fill_discrete(name = "House type", labels = c("A", "B", "C")))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + scale_fill_discrete(name = "House type", labels = c("A", "B", "C")))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + scale_fill_discrete(name = "House type", labels = c("A", "B", "C")))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",
legend.direction = "horizontal")) + scale_fill_discrete(name = "House type", labels = c("A", "B", "C"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",
legend.direction = "horizontal")) + scale_fill_discrete(name = "House type", labels = c("A", "B", "C"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal")) + scale_fill_discrete(name = "House type", labels = c("A", "B", "C"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal")))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal"))
library(grid)
# Investigating BBR data --------------------------------------------------
HouseType <- c(BBR$HouseType)
legend11 <- "Type 1: Parcel"
my_grob = grid.text(legend11, x=0.7,  y=0.8, gp=gpar(col="firebrick", fontsize=14, fontface="bold"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob))
my_grob = grid.text(legend11, x=0.6,  y=0.8, gp=gpar(col="black", fontsize=14, fontface="bold"))
my_grob = grid.text(legend11, x=0.1,  y=0.9, gp=gpar(col="black", fontsize=14, fontface="bold"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob))
my_grob = grid.text(legend11, x=0.2,  y=0.9, gp=gpar(col="black", fontsize=14, fontface="bold"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob))
BBR$HouseType
legend11 <- "Type 1: Industry \n Type 2: Public buildings"
my_grob = grid.text(legend11, x=0.2,  y=0.9, gp=gpar(col="black", fontsize=14, fontface="bold"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob))
legend11 <- "Type 1: Industry \n Type 2: Public \n Type 3: Apartment \n Type 4: Parcel \n Type 5: Terrace"
my_grob = grid.text(legend11, x=0.2,  y=0.9, gp=gpar(col="black", fontsize=14, fontface="bold"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob))
legend11 <- "Type 1: Industry \n Type 2: Public \n Type 3: Apartment \n Type 4: Parcel \n Type 5: Terrace"
my_grob = grid.text(legend11, x=0.2,  y=0.9, gp=gpar(col="black", fontsize=8, fontface="bold"))
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob))
legend11 <- "Type 1: Industry \n Type 2: Public \n Type 3: Apartment \n Type 4: Parcel \n Type 5: Terrace"
my_grob = grid.text(legend11, x=0.2,  y=0.9, gp=gpar(col="black", fontsize=10, fontface="bold"), just = "left")
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob))
legend11 <- "Type 1: Industry \n Type 2: Public \n Type 3: Apartment \n Type 4: Parcel \n Type 5: Terrace"
my_grob = grid.text(legend11, x=0.2,  y=0.7, gp=gpar(col="black", fontsize=10, fontface="bold"), just = "left")
# Investigating BBR data --------------------------------------------------
HouseType <- c(BBR$HouseType)
legend11 <- "Type 1: Industry \n Type 2: Public \n Type 3: Apartment \n Type 4: Parcel \n Type 5: Terrace"
my_grob = grid.text(legend11, x=0.2,  y=0.8, gp=gpar(col="black", fontsize=10, fontface="bold"), just = "left")
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob))
legend11 <- "Type 1: Industry \n Type 2: Public \n Type 3: Apartment \n Type 4: Parcel \n Type 5: Terrace"
my_grob = grid.text(legend11, x=0.1,  y=0.8, gp=gpar(col="black", fontsize=10, fontface="bold"), just = "left")
(plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob))
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 15)
plot13 <- ggplot(data = BBR, aes(x = ConstructionYear)) + geom_histogram(bins = 15)
plot14 <- ggplot(data = BBR, aes(x = ReconstructionYear)) + geom_histogram(bins = 15)
grid.arrange(plot11, plot12, plot13, plot14, nrow = 2, ncol = 2)
my_grob = grid.text(legend11, x=0.1,  y=0.7, gp=gpar(col="black", fontsize=10, fontface="bold"), just = "left")
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 15)
plot13 <- ggplot(data = BBR, aes(x = ConstructionYear)) + geom_histogram(bins = 15)
plot14 <- ggplot(data = BBR, aes(x = ReconstructionYear)) + geom_histogram(bins = 15)
grid.arrange(plot11, plot12, plot13, plot14, nrow = 2, ncol = 2)
my_grob = grid.text(legend11, x=0.1,  y=0.7, gp=gpar(col="black", fontsize=8, fontface="bold"), just = "left")
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 15)
plot13 <- ggplot(data = BBR, aes(x = ConstructionYear)) + geom_histogram(bins = 15)
plot14 <- ggplot(data = BBR, aes(x = ReconstructionYear)) + geom_histogram(bins = 15)
grid.arrange(plot11, plot12, plot13, plot14, nrow = 2, ncol = 2)
my_grob = grid.text(legend11, x=0.1,  y=0.7, gp=gpar(col="black", fontsize=7, fontface="bold"), just = "left")
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 15)
plot13 <- ggplot(data = BBR, aes(x = ConstructionYear)) + geom_histogram(bins = 15)
plot14 <- ggplot(data = BBR, aes(x = ReconstructionYear)) + geom_histogram(bins = 15)
grid.arrange(plot11, plot12, plot13, plot14, nrow = 2, ncol = 2)
my_grob = grid.text(legend11, x=0.2,  y=0.7, gp=gpar(col="black", fontsize=7, fontface="bold"), just = "left")
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 15)
plot13 <- ggplot(data = BBR, aes(x = ConstructionYear)) + geom_histogram(bins = 15)
plot14 <- ggplot(data = BBR, aes(x = ReconstructionYear)) + geom_histogram(bins = 15)
grid.arrange(plot11, plot12, plot13, plot14, nrow = 2, ncol = 2)
legend11 <- "Type 1: Industry \n Type 2: Public \n Type 3: Apartment \n Type 4: Parcel \n Type 5: Terrace"
my_grob = grid.text(legend11, x=0.1,  y=0.8, gp=gpar(col="black", fontsize=7, fontface="bold"), just = "left")
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 15)
plot13 <- ggplot(data = BBR, aes(x = ConstructionYear)) + geom_histogram(bins = 15)
plot14 <- ggplot(data = BBR, aes(x = ReconstructionYear)) + geom_histogram(bins = 15)
grid.arrange(plot11, plot12, plot13, plot14, nrow = 2, ncol = 2)
legend11 <- "Type 1: Industry \n Type 2: Public \n Type 3: Apartment \n Type 4: Parcel \n Type 5: Terrace"
my_grob = grid.text(legend11, x=0.1,  y=0.8, gp=gpar(col="black", fontsize=10, fontface="bold"), just = "left")
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 15)
plot13 <- ggplot(data = BBR, aes(x = ConstructionYear)) + geom_histogram(bins = 15)
plot14 <- ggplot(data = BBR, aes(x = ReconstructionYear)) + geom_histogram(bins = 15)
grid.arrange(plot11, plot12, plot13, plot14, nrow = 2, ncol = 2)
my_grob = grid.text(legend11, x=0.1,  y=0.8, gp=gpar(col="black", fontsize=12, fontface="bold"), just = "left")
plot11 <- ggplot(data = data.frame(HouseType), aes(x = HouseType)) + geom_histogram(bins = 15) + theme(legend.position = "topleft",legend.direction = "horizontal") + annotation_custom(my_grob)
plot12 <- ggplot(data = BBR, aes(x = TotalArea)) + geom_histogram(bins = 15)
plot13 <- ggplot(data = BBR, aes(x = ConstructionYear)) + geom_histogram(bins = 15)
plot14 <- ggplot(data = BBR, aes(x = ReconstructionYear)) + geom_histogram(bins = 15)
grid.arrange(plot11, plot12, plot13, plot14, nrow = 2, ncol = 2)
