dates = as.yearmon(time(obs2))
axis(1, at = seq(tsp[1], tsp[2], along = obs2), labels = dates)
points(dates[17:18], c(232.6,210.65), col = "red", pch = 20)
segments(x0=dates[17],y0=232.6+qnorm(0.975)*7,x1=dates[17],y1=232.6-qnorm(0.975)*7,col="green")
segments(x0=dates[18],y0=210.65+qnorm(0.975)*7*sqrt(1.25),x1=dates[18],y1=210.65-qnorm(0.975)*7*sqrt(1.25),col="green")
legend(x="topleft",legend = c("Observations","Predictions","95% prediction interval"),pch=c(20,20,NA),lty = c(NA,NA,1),col = c(1,"red","green"))
## Question 2.3 ##
# 1. model
ARMA <- arima.sim(n=200,list(order = c(1,0,0),ar = c(0.85)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 2. model
ARMA <- arima.sim(n=200,list(order = c(12,0,0),ar = c(rep(0,11),0.8)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (0,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 3. model
ARMA <- arima.sim(n=200,list(order = c(1,0,12),ar = 0.8,ma =c(rep(0,11),0.7)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(0,0,1) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 4. model
ARMA <- arima.sim(n=200,list(order = c(13,0,0),ar = c(0.7,rep(0,10),-0.8,0.56)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 5. model
ARMA <- arima.sim(n=200,list(order = c(14,0,0),ar = c(-0.6,-0.6,rep(0,9),-0.8,-0.48,-0.48)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (2,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 5. model
ARMA <- arima.sim(n=200,list(order = c(0,0,13),ma = c(-0.7,rep(0,10),0.8,-0.56)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (0,0,1)x(0,0,1) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
par(mfrow=c(1,1))
ACF <- acf(ARMASIM[1,],plot=FALSE,lag.max=lagmax)
plot(ACF, type="l", max.mfrow=1, ylim=c(-.5,1),col=1,ylab = "Autocorrelations",main="Autocorrelations for different realizations",
xlim = c(0,lagmax-1/2))
points(0:lagmax,ACF$acf[,1,1],col=colours[i],pch=20,cex=0.8)
for (i in 2:10){
ACF =  acf(ARMASIM[i,],plot=FALSE,lag.max=lagmax)
lines(0:lagmax,ACF$acf[,1,1], lty=1, col=colours[i], lwd=1)
points(0:lagmax,ACF$acf[,1,1],col=colours[i],pch=20,cex=0.8)
}
ARMA <- arima.sim(n=200,list(order = c(12,0,0),ar = c(rep(0,11),0.8)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (0,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
ARMA <- arima.sim(n=200,list(order = c(1,0,0),ar = c(0.85)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
## Question 2.3 ##
# 1. model
ARMA <- arima.sim(n=200,list(order = c(1,0,0),ar = -0.85)
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
######### Assignment 2 ###################
## ARMA Processes and Seasonal Processes ##
rm(list=ls())
library("RColorBrewer")
set.seed(0)
lagmax=50
colours = brewer.pal(n=10,name = "Paired")
# Question 2.1: Stability
ARMASIM <- matrix(rep(NA,200*10),nrow = 10)
ARMASIM[1,] = arima.sim(n=200, list(order = c(1,0,2),ar = 0.9, ma=c(2,0.5)),sd = 0.2)
plot(ARMASIM[1,],type="l",col=colours[1], ylim=c(-5,5), ylab = "Process values", xlab = "Time", main = "10 Realizations of the same process")
for (i in 2:10)
{
ARMASIM[i,] = arima.sim(n=200, list(ar = 0.9, ma=c(2,0.5)),sd = 0.2)
lines(ARMASIM[i,],type="l",col=colours[i])
}
ACF <- acf(ARMASIM[1,],plot=FALSE,lag.max=lagmax)
plot(ACF, type="l", max.mfrow=1, ylim=c(-.5,1),col=1,ylab = "Autocorrelations",main="Autocorrelations for different realizations",
xlim = c(0,lagmax-1/2))
points(0:lagmax,ACF$acf[,1,1],col=colours[i],pch=20,cex=0.8)
for (i in 2:10){
ACF =  acf(ARMASIM[i,],plot=FALSE,lag.max=lagmax)
lines(0:lagmax,ACF$acf[,1,1], lty=1, col=colours[i], lwd=1)
points(0:lagmax,ACF$acf[,1,1],col=colours[i],pch=20,cex=0.8)
}
legend(x = "topright", legend = "95% confidence interval", lty=2, col="blue")
PACF <- pacf(ARMASIM[1,],plot=FALSE,lag.max=lagmax)
plot(PACF, type="l", max.mfrow=1, ylim=c(-.6,1),col=colours[1],ylab = "Partial autocorrelations",main="Partial autocorrelations for different realizations",
xlim = c(0,lagmax-1/2))
points(1:lagmax,PACF$acf[,1,1],col=colours[1],pch=20,cex=0.8)
legend(x = "topright", legend = "95% confidence interval", lty=2, col="blue")
for (i in 2:10){
PACF =  pacf(ARMASIM[i,],plot=FALSE,lag.max=lagmax)
lines(1:(lagmax),PACF$acf[,1,1], lty=1, col=colours[i], lwd=1)
points(1:lagmax,PACF$acf[,1,1],col=colours[i],pch=20,cex=0.8)
}
Var <- rep(NA,10)
for (i in 1:10){
ACF = acf(ARMASIM[i,],type="covariance",plot=FALSE, lag.max = lagmax)
Var[i] = ACF$acf[1,1,1]
}
## Question 2.2 ##
require(xts)
obs <- c(190, 208,213,223,237,214,221,201,191,184,184,189,188,207,221,225)
obs <- ts(obs, frequency = 12, start = c(2015,9))
plot(obs, type='l',main="Electricity consumption pr. month",xaxt='n',
xlab = 'Time', ylab = 'Energy consumption')
points(obs, pch = 20,cex=1)
tsp = attributes(obs)$tsp
dates = as.yearmon(time(obs))
axis(1, at = seq(tsp[1], tsp[2], along = obs), labels = dates)
require(xts)
obs2 <- c(190, 208,213,223,237,214,221,201,191,184,184,189,188,207,221,225,232.6,210.65)
obs2 <- ts(obs2, frequency = 12, start = c(2015,9))
plot(obs2,type='p',main="Electricity consumption pr. month",xaxt='n',
xlab = 'Time', ylab = 'Energy consumption',pch=20, cex=0.01, ylim = c(180,260))
lines(obs)
points(obs,pch = 20, cex = 1)
tsp = attributes(obs2)$tsp
dates = as.yearmon(time(obs2))
axis(1, at = seq(tsp[1], tsp[2], along = obs2), labels = dates)
points(dates[17:18], c(232.6,210.65), col = "red", pch = 20)
segments(x0=dates[17],y0=232.6+qnorm(0.975)*7,x1=dates[17],y1=232.6-qnorm(0.975)*7,col="green")
segments(x0=dates[18],y0=210.65+qnorm(0.975)*7*sqrt(1.25),x1=dates[18],y1=210.65-qnorm(0.975)*7*sqrt(1.25),col="green")
legend(x="topleft",legend = c("Observations","Predictions","95% prediction interval"),pch=c(20,20,NA),lty = c(NA,NA,1),col = c(1,"red","green"))
## Question 2.3 ##
# 1. model
ARMA <- arima.sim(n=200,list(order = c(1,0,0),ar = -0.85))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 2. model
ARMA <- arima.sim(n=200,list(order = c(12,0,0),ar = c(rep(0,11),0.8)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (0,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 3. model
ARMA <- arima.sim(n=200,list(order = c(1,0,12),ar = 0.8,ma =c(rep(0,11),0.7)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(0,0,1) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 4. model
ARMA <- arima.sim(n=200,list(order = c(13,0,0),ar = c(0.7,rep(0,10),-0.8,0.56)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 5. model
ARMA <- arima.sim(n=200,list(order = c(14,0,0),ar = c(-0.6,-0.6,rep(0,9),-0.8,-0.48,-0.48)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (2,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 5. model
ARMA <- arima.sim(n=200,list(order = c(0,0,13),ma = c(-0.7,rep(0,10),0.8,-0.56)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (0,0,1)x(0,0,1) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
par(mfrow=c(1,1))
######### Assignment 2 ###################
## ARMA Processes and Seasonal Processes ##
rm(list=ls())
library("RColorBrewer")
set.seed(0)
lagmax=50
colours = brewer.pal(n=10,name = "Paired")
# Question 2.1: Stability
ARMASIM <- matrix(rep(NA,200*10),nrow = 10)
ARMASIM[1,] = arima.sim(n=200, list(order = c(1,0,2),ar = 0.9, ma=c(2,0.5)),sd = 0.2)
plot(ARMASIM[1,],type="l",col=colours[1], ylim=c(-5,5), ylab = "Process values", xlab = "Time", main = "10 Realizations of the same process")
for (i in 2:10)
{
ARMASIM[i,] = arima.sim(n=200, list(ar = 0.9, ma=c(2,0.5)),sd = 0.2)
lines(ARMASIM[i,],type="l",col=colours[i])
}
ACF <- acf(ARMASIM[1,],plot=FALSE,lag.max=lagmax)
plot(ACF, type="l", max.mfrow=1, ylim=c(-.5,1),col=1,ylab = "Autocorrelations",main="Autocorrelations for different realizations",
xlim = c(0,lagmax-1/2))
points(0:lagmax,ACF$acf[,1,1],col=colours[i],pch=20,cex=0.8)
for (i in 2:10){
ACF =  acf(ARMASIM[i,],plot=FALSE,lag.max=lagmax)
lines(0:lagmax,ACF$acf[,1,1], lty=1, col=colours[i], lwd=1)
points(0:lagmax,ACF$acf[,1,1],col=colours[i],pch=20,cex=0.8)
}
legend(x = "topright", legend = "95% confidence interval", lty=2, col="blue")
PACF <- pacf(ARMASIM[1,],plot=FALSE,lag.max=lagmax)
plot(PACF, type="l", max.mfrow=1, ylim=c(-.6,1),col=colours[1],ylab = "Partial autocorrelations",main="Partial autocorrelations for different realizations",
xlim = c(0,lagmax-1/2))
points(1:lagmax,PACF$acf[,1,1],col=colours[1],pch=20,cex=0.8)
legend(x = "topright", legend = "95% confidence interval", lty=2, col="blue")
for (i in 2:10){
PACF =  pacf(ARMASIM[i,],plot=FALSE,lag.max=lagmax)
lines(1:(lagmax),PACF$acf[,1,1], lty=1, col=colours[i], lwd=1)
points(1:lagmax,PACF$acf[,1,1],col=colours[i],pch=20,cex=0.8)
}
Var <- rep(NA,10)
for (i in 1:10){
ACF = acf(ARMASIM[i,],type="covariance",plot=FALSE, lag.max = lagmax)
Var[i] = ACF$acf[1,1,1]
}
## Question 2.2 ##
require(xts)
obs <- c(190, 208,213,223,237,214,221,201,191,184,184,189,188,207,221,225)
obs <- ts(obs, frequency = 12, start = c(2015,9))
plot(obs, type='l',main="Electricity consumption pr. month",xaxt='n',
xlab = 'Time', ylab = 'Energy consumption')
points(obs, pch = 20,cex=1)
tsp = attributes(obs)$tsp
dates = as.yearmon(time(obs))
axis(1, at = seq(tsp[1], tsp[2], along = obs), labels = dates)
require(xts)
obs2 <- c(190, 208,213,223,237,214,221,201,191,184,184,189,188,207,221,225,232.6,210.65)
obs2 <- ts(obs2, frequency = 12, start = c(2015,9))
plot(obs2,type='p',main="Electricity consumption pr. month",xaxt='n',
xlab = 'Time', ylab = 'Energy consumption',pch=20, cex=0.01, ylim = c(180,260))
lines(obs)
points(obs,pch = 20, cex = 1)
tsp = attributes(obs2)$tsp
dates = as.yearmon(time(obs2))
axis(1, at = seq(tsp[1], tsp[2], along = obs2), labels = dates)
points(dates[17:18], c(232.6,210.65), col = "red", pch = 20)
segments(x0=dates[17],y0=232.6+qnorm(0.975)*7,x1=dates[17],y1=232.6-qnorm(0.975)*7,col="green")
segments(x0=dates[18],y0=210.65+qnorm(0.975)*7*sqrt(1.25),x1=dates[18],y1=210.65-qnorm(0.975)*7*sqrt(1.25),col="green")
legend(x="topleft",legend = c("Observations","Predictions","95% prediction interval"),pch=c(20,20,NA),lty = c(NA,NA,1),col = c(1,"red","green"))
## Question 2.3 ##
# 1. model
ARMA <- arima.sim(n=200,list(order = c(1,0,0),ar = -0.85))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 2. model
ARMA <- arima.sim(n=200,list(order = c(12,0,0),ar = c(rep(0,11),0.8)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (0,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 3. model
ARMA <- arima.sim(n=200,list(order = c(1,0,12),ar = 0.8,ma =c(rep(0,11),0.7)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(0,0,1) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 4. model
ARMA <- arima.sim(n=200,list(order = c(13,0,0),ar = c(0.7,rep(0,10),-0.8,0.56)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 5. model
ARMA <- arima.sim(n=200,list(order = c(14,0,0),ar = c(-0.6,-0.6,rep(0,9),-0.8,-0.48,-0.48)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (2,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 5. model
ARMA <- arima.sim(n=200,list(order = c(0,0,13),ma = c(-0.7,rep(0,10),0.8,-0.56)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (0,0,1)x(0,0,1) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
par(mfrow=c(1,1))
require(xts)
obs2 <- c(190, 208,213,223,237,214,221,201,191,184,184,189,188,207,221,225,232.6,210.65)
obs2 <- ts(obs2, frequency = 12, start = c(2015,9))
plot(obs2,type='p',main="Electricity consumption pr. month",xaxt='n',
xlab = 'Time', ylab = 'Energy consumption',pch=20, cex=0.01, ylim = c(180,260))
lines(obs)
points(obs,pch = 20, cex = 1)
tsp = attributes(obs2)$tsp
dates = as.yearmon(time(obs2))
axis(1, at = seq(tsp[1], tsp[2], along = obs2), labels = dates)
points(dates[17:18], c(232.6,210.65), col = "red", pch = 20)
segments(x0=dates[17],y0=232.6+qnorm(0.975)*7,x1=dates[17],y1=232.6-qnorm(0.975)*7,col="green")
segments(x0=dates[18],y0=210.65+qnorm(0.975)*7*sqrt(1.25),x1=dates[18],y1=210.65-qnorm(0.975)*7*sqrt(1.25),col="green")
legend(x="topleft",legend = c("Observations","Predictions","95% prediction interval"),pch=c(20,20,NA),lty = c(NA,NA,1),col = c(1,"red","green"))
## Question 2.3 ##
# 1. model
ARMA <- arima.sim(n=200,list(order = c(1,0,0),ar = -0.85))
######### Assignment 2 ###################
## ARMA Processes and Seasonal Processes ##
rm(list=ls())
library("RColorBrewer")
set.seed(0)
lagmax=50
colours = brewer.pal(n=10,name = "Paired")
# Question 2.1: Stability
ARMASIM <- matrix(rep(NA,200*10),nrow = 10)
ARMASIM[1,] = arima.sim(n=200, list(order = c(1,0,2),ar = 0.9, ma=c(2,0.5)),sd = 0.2)
plot(ARMASIM[1,],type="l",col=colours[1], ylim=c(-5,5), ylab = "Process values", xlab = "Time", main = "10 Realizations of the same process")
for (i in 2:10)
{
ARMASIM[i,] = arima.sim(n=200, list(ar = 0.9, ma=c(2,0.5)),sd = 0.2)
lines(ARMASIM[i,],type="l",col=colours[i])
}
ACF <- acf(ARMASIM[1,],plot=FALSE,lag.max=lagmax)
plot(ACF, type="l", max.mfrow=1, ylim=c(-.5,1),col=1,ylab = "Autocorrelations",main="Autocorrelations for different realizations",
xlim = c(0,lagmax-1/2))
points(0:lagmax,ACF$acf[,1,1],col=colours[i],pch=20,cex=0.8)
for (i in 2:10){
ACF =  acf(ARMASIM[i,],plot=FALSE,lag.max=lagmax)
lines(0:lagmax,ACF$acf[,1,1], lty=1, col=colours[i], lwd=1)
points(0:lagmax,ACF$acf[,1,1],col=colours[i],pch=20,cex=0.8)
}
legend(x = "topright", legend = "95% confidence interval", lty=2, col="blue")
PACF <- pacf(ARMASIM[1,],plot=FALSE,lag.max=lagmax)
plot(PACF, type="l", max.mfrow=1, ylim=c(-.6,1),col=colours[1],ylab = "Partial autocorrelations",main="Partial autocorrelations for different realizations",
xlim = c(0,lagmax-1/2))
points(1:lagmax,PACF$acf[,1,1],col=colours[1],pch=20,cex=0.8)
legend(x = "topright", legend = "95% confidence interval", lty=2, col="blue")
for (i in 2:10){
PACF =  pacf(ARMASIM[i,],plot=FALSE,lag.max=lagmax)
lines(1:(lagmax),PACF$acf[,1,1], lty=1, col=colours[i], lwd=1)
points(1:lagmax,PACF$acf[,1,1],col=colours[i],pch=20,cex=0.8)
}
Var <- rep(NA,10)
for (i in 1:10){
ACF = acf(ARMASIM[i,],type="covariance",plot=FALSE, lag.max = lagmax)
Var[i] = ACF$acf[1,1,1]
}
## Question 2.2 ##
require(xts)
obs <- c(190, 208,213,223,237,214,221,201,191,184,184,189,188,207,221,225)
obs <- ts(obs, frequency = 12, start = c(2015,9))
plot(obs, type='l',main="Electricity consumption pr. month",xaxt='n',
xlab = 'Time', ylab = 'Energy consumption')
points(obs, pch = 20,cex=1)
tsp = attributes(obs)$tsp
dates = as.yearmon(time(obs))
axis(1, at = seq(tsp[1], tsp[2], along = obs), labels = dates)
require(xts)
obs2 <- c(190, 208,213,223,237,214,221,201,191,184,184,189,188,207,221,225,232.6,210.65)
obs2 <- ts(obs2, frequency = 12, start = c(2015,9))
plot(obs2,type='p',main="Electricity consumption pr. month",xaxt='n',
xlab = 'Time', ylab = 'Energy consumption',pch=20, cex=0.01, ylim = c(180,260))
lines(obs)
points(obs,pch = 20, cex = 1)
tsp = attributes(obs2)$tsp
dates = as.yearmon(time(obs2))
axis(1, at = seq(tsp[1], tsp[2], along = obs2), labels = dates)
points(dates[17:18], c(232.6,210.65), col = "red", pch = 20)
segments(x0=dates[17],y0=232.6+qnorm(0.975)*7,x1=dates[17],y1=232.6-qnorm(0.975)*7,col="green")
segments(x0=dates[18],y0=210.65+qnorm(0.975)*7*sqrt(1.25),x1=dates[18],y1=210.65-qnorm(0.975)*7*sqrt(1.25),col="green")
legend(x="topleft",legend = c("Observations","Predictions","95% prediction interval"),pch=c(20,20,NA),lty = c(NA,NA,1),col = c(1,"red","green"))
## Question 2.3 ##
# 1. model
ARMA <- arima.sim(n=200,list(order = c(1,0,0),ar = -0.85))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(0,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 2. model
ARMA <- arima.sim(n=200,list(order = c(12,0,0),ar = c(rep(0,11),0.8)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (0,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 3. model
ARMA <- arima.sim(n=200,list(order = c(1,0,12),ar = 0.8,ma =c(rep(0,11),0.7)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(0,0,1) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 4. model
ARMA <- arima.sim(n=200,list(order = c(13,0,0),ar = c(0.7,rep(0,10),-0.8,0.56)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (1,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 5. model
ARMA <- arima.sim(n=200,list(order = c(14,0,0),ar = c(-0.6,-0.6,rep(0,9),-0.8,-0.48,-0.48)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (2,0,0)x(1,0,0) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
# 5. model
ARMA <- arima.sim(n=200,list(order = c(0,0,13),ma = c(-0.7,rep(0,10),0.8,-0.56)))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE),
widths=c(1,1), heights=c(1,1))
plot(ARMA,type="l",col=1, ylim=c(-5,5), ylab = "Process values", xlab = "Time",
main = "Plot of a (0,0,1)x(0,0,1) seasonal model")
par(mar=c(5,4,2,2)+0.1)
acf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
pacf(ARMA,main="",lag.max = 50, panel.first = c(abline(v=(1:4)*12,col="red",lty=2)))
par(mfrow=c(1,1))
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
par(mar=c(3,3,2,1), mgp=c(2,0.7,0))
source("data.R")
plot(data[[1]]$CoolingDegree ~ (data[[1]]$TemperatureIn - data[[1]]$TemperatureOut))
plot(data[[1]]$CoolingDegree, (data[[1]]$TemperatureIn - data[[1]]$TemperatureOut))
plot(data[[1]]$CoolingDegree*data[[1]]$Flow, weather$Temperature)
tmp <- weather[(weather$StartDateTime <= EndDays[1]),]
tmp <- tmp[tmp$StartDateTime >= StartDays[1],]
plot(data[[1]]$CoolingDegree*data[[1]]$Flow, tmp$Temperature)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
par(mar=c(3,3,2,1), mgp=c(2,0.7,0))
source("data.R")
pairs(data[[1]])
plot(data[[1]]$Flow)
plot.months <- c("January", "February", "March", "April", "May", "June", "July", "August",
"September", "November", "December")
par(mfrow = c(1,1))
time <- seq(as.Date(StartDays[1]),as.Date(EndDays[1]), by = "1 mon")
plot(data[[1]]$StartDateTime, data[[1]]$Flow, "l", xaxt = 'n')
drawxaxis(data[[1]]$StartDateTime, tick.tstep="months")
axis.Date(1, at = seq(min(time), max(time), by = "12 mon"), format = "%m")
# Investigating each house's flow behaviour
for (i in 1:1){
#data[[i]]$StartDateTime.new <- as.POSIXlt(data[[i]]$StartDateTime)
#data[[i]]$StartDateTime <- as.Date(data[[i]]$StartDateTime, "%Y-%m-%d")
#data[[i]]$StartDateTime2 <- as.Date(cut(data[[i]]$StartDateTime, breaks = "month"))
plot(data[[i]]$StartDateTime, data[[i]]$Flow, type = "l", xlab ="Time", ylab = "Flow")
axis(1, at = unique(months(data[[i]]$StartDateTime)), las = 2)
}
tmp <- weather[(weather$StartDateTime <= EndDays[1]),]
tmp <- tmp[tmp$StartDateTime >= StartDays[1],]
plot(data[[1]]$CoolingDegree*data[[1]]$Flow, tmp$Temperature)
str(tmp$Temperature)
str(data[[1]]$CoolingDegree)
plot(data[[1]]$CoolingDegree*data[[1]]$Flow, tmp$Temperature[-1])
